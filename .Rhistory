"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>%  plyr::rename(
midlife_HP_df$`Left-Hippocampus` = "t1_lefthipp_freesurfer"
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>%  dplyr::rename(
midlife_HP_df$`Left-Hippocampus` = t1_lefthipp_freesurfer
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>%  dplyr::rename(
midlife_HP_df$`Left-Hippocampus`=t1_lefthipp_freesurfer
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>%  dplyr::rename(t1_lefthipp_freesurfer=midlife_HP_df$`Left-Hippocampus`
)
View(midlife_HP_df)
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2)
# midlife_HP_df$`Right-Hippocampus` = "t1_righthipp_freesurfer",
# eTIV = "eTIV_freesurfer"
View(midlife_HP_df)
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>% filter(!is.na(eTIV)) # Need to make sure we remove subj without scan
# 1 Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/midlife_HP_df$eTIV)
# 2 Let's correct by mutating the columns using the TIV from freesurfer
midlife_HP_df <- midlife_HP_df %>% mutate_at(vars(avg_t1_hipp, `Left-Hippocampus`, `Right-Hippocampus`),
dividebyTIV) %>%
# multiplying to get proportions
mutate(avg_t1_hipp = avg_t1_hipp*1000,
`Left-Hippocampus` = `Left-Hippocampus`*1000,
`Right-Hippocampus` = `Right-Hippocampus`*1000)
midlife_female_raw_df <- midlife_raw_df %>% filter(sex=="Female")
midlife_male_raw_df <- <- midlife_raw_df %>% filter(sex=="Male")
midlife_male_raw_df <- midlife_raw_df %>% filter(sex=="Male")
midlife_HP_female_df <- midlife_HP_df %>% filter(sex= "Female")
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>% filter(!is.na(eTIV)) # Need to make sure we remove subj without scan # N=43
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>% filter(!is.na(eTIV))
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2)
workingdir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/LOOP"
LOOP_raw_df <- read_csv(paste0(workingdir,"/LOOP_all_data.csv"))
midlife_raw_df <- LOOP_raw_df %>% filter(age_group=="Midlife")  %>% filter(subject_id != 372) # Excluding these 372 because they had a brain worm or something  #53
midlife_female_raw_df <- midlife_raw_df %>% filter(sex=="Female")
midlife_male_raw_df <- midlife_raw_df %>% filter(sex=="Male")
young_raw_df <- LOOP_raw_df %>% filter(age_group=="Young") %>% filter(completed_scan == "Yes") # Making sure we only use scan subjects N= 32
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (midlife_HP_df$`Left-Hippocampus` + midlife_HP_df$`Right-Hippocampus`) /
2) %>% filter(!is.na(eTIV)) # Need to make sure we remove subj without scan # N=43
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV"
) %>% mutate(avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) /
2) %>% filter(!is.na(eTIV)) # Need to make sure we remove subj without scan # N=43
midlife_HP_female_df <- midlife_HP_df %>% filter(sex=="Female")
midlife_HP_male_df <- midlife_HP_df %>%  filter(sex== "Male")
