cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled at 3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_avg_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_rad3_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
#Creating an empty table to put everything in
normality_young_HP <- data.frame(matrix(ncol = 4, nrow = 0)) %>% `colnames<-`(c("statistic", "pvalue", "method", "variable"))
#LOOP: position error
normality_young_HP[1,] <- unlist(shapiro.test(young_HP_df$loop_pe_rad3_m)) #normal
normality_young_HP[2,] <- unlist(shapiro.test(young_HP_female_df$loop_pe_rad3_m)) #normal
normality_young_HP[3,] <- unlist(shapiro.test(young_HP_male_df$loop_pe_rad3_m)) #normal
#LOOP: position error average
normality_young_HP[4,] <-unlist(shapiro.test(young_HP_df$loop_pe_avg_m)) #normal
normality_young_HP[5,] <-unlist(shapiro.test(young_HP_female_df$loop_pe_avg_m)) #normal
normality_young_HP[6,] <-unlist(shapiro.test(young_HP_male_df$loop_pe_avg_m)) #normal
#LOOP: degrees traveled
normality_young_HP[7,] <-unlist(shapiro.test(young_HP_df$loop_de_rad3_degree))  #notnormal
normality_young_HP[8,] <-unlist(shapiro.test(young_HP_female_df$loop_de_rad3_degree))  #normal
normality_young_HP[9,] <-unlist(shapiro.test(young_HP_male_df$loop_de_rad3_degree) ) #notnormal
normality_young_HP[10,] <-unlist(shapiro.test(young_HP_df$loop_de_avg_degree))  #normal
normality_young_HP[11,] <-unlist(shapiro.test(young_HP_female_df$loop_de_avg_degree))  #normal
normality_young_HP[12,] <-unlist(shapiro.test(young_HP_male_df$loop_de_avg_degree))  #normal
#LOOP: angular error
normality_young_HP[13,] <-unlist(shapiro.test(young_HP_df$loop_ae_rad3_degree))  #normal
normality_young_HP[14,] <-unlist(shapiro.test(young_HP_female_df$loop_ae_rad3_degree))  #normal
normality_young_HP[15,] <-unlist(shapiro.test(young_HP_male_df$loop_ae_rad3_degree))  #normal
normality_young_HP[16,] <-unlist(shapiro.test(young_HP_df$loop_ae_avg_degree))  # notnormal
normality_young_HP[17,] <-unlist(shapiro.test(young_HP_female_df$loop_ae_avg_degree))  #notnormal
normality_young_HP[18,] <-unlist(shapiro.test(young_HP_male_df$loop_ae_avg_degree))  #no
normality_young_HP
View(normality_young_HP)
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_avg_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_rad3_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_avg_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_rad3_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_ae_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_pe_avg_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_pe_rad3_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_pe_rad3_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_ae_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_ae_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_ae_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_de_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_de_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at aver3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
library(ggplot2)
library(tidyverse)
library(stringr)
library(kableExtra)
# library(tidygraph)
# library(plotly)
#library(factoextra)
#library(lsr)
library(ggpubr)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(gridExtra)
library(markdown)
library(psych)
library(ppcor)
workingdir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/LOOP"
LOOP_raw_df <- read_csv(paste0(workingdir,"/LOOP_all_data.csv"))
midlife_raw_df <- LOOP_raw_df %>% filter(age_group=="Midlife")  %>% filter(subject_id != 372) # Excluding these 372 because they had a brain worm or something  #53
midlife_female_raw_df <- midlife_raw_df %>% filter(sex=="Female")
midlife_male_raw_df <- midlife_raw_df %>% filter(sex=="Male")
young_raw_df <- LOOP_raw_df %>% filter(age_group=="Young") %>% filter(completed_scan == "Yes") # Making sure we only use scan subjects N= 32
data.frame(c(
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub")) %>% `colnames<-`("columns") %>% kable() %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV",
"estradiol_scan_pg_ml",
"progesterone_scan_ng_ml",
"fsh_scan_miu_ml",
"shbg_scan_nmol_l",
"dheas_scan_ug_dl",
"testosterone_scan_ng_dl",
"estradiol_spatial_pg_ml",
"progesterone_spatial_ng_ml",
"fsh_spatial_miu_ml",
"shbg_spatial_nmol_l",
"dheas_spatial_ug_dl",
"testosterone_spatial_ng_dl"
) %>% mutate(avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) /
2) %>% filter(!is.na(eTIV)) %>% mutate(
avg_t2_total_hipp = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub,
left_t2_total_hipp = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub,
right_t2_total_hipp = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub
)  # N=43
midlife_HP_female_df <- midlife_HP_df %>% filter(sex=="Female")
midlife_HP_male_df <- midlife_HP_df %>%  filter(sex== "Male")
#Creating an empty table to put everything in
normality_midlife_HP <- data.frame(matrix(ncol = 4, nrow = 0)) %>% `colnames<-`(c("statistic", "pvalue", "method", "variable"))
#LOOP: position error
normality_midlife_HP[1,] <- unlist(shapiro.test(midlife_HP_df$loop_pe_rad3_m)) #normal
normality_midlife_HP[2,] <- unlist(shapiro.test(midlife_HP_female_df$loop_pe_rad3_m)) #normal
normality_midlife_HP[3,] <- unlist(shapiro.test(midlife_HP_male_df$loop_pe_rad3_m)) #normal
#LOOP: position error average
normality_midlife_HP[4,] <-unlist(shapiro.test(midlife_HP_df$loop_pe_avg_m)) #normal
normality_midlife_HP[5,] <-unlist(shapiro.test(midlife_HP_female_df$loop_pe_avg_m)) #normal
normality_midlife_HP[6,] <-unlist(shapiro.test(midlife_HP_male_df$loop_pe_avg_m)) #normal
#LOOP: degrees traveled
normality_midlife_HP[7,] <-unlist(shapiro.test(midlife_HP_df$loop_de_rad3_degree))  #notnormal
normality_midlife_HP[8,] <-unlist(shapiro.test(midlife_HP_female_df$loop_de_rad3_degree))  #normal
normality_midlife_HP[9,] <-unlist(shapiro.test(midlife_HP_male_df$loop_de_rad3_degree) ) #notnormal
normality_midlife_HP[10,] <-unlist(shapiro.test(midlife_HP_df$loop_de_avg_degree))  #normal
normality_midlife_HP[11,] <-unlist(shapiro.test(midlife_HP_female_df$loop_de_avg_degree))  #normal
normality_midlife_HP[12,] <-unlist(shapiro.test(midlife_HP_male_df$loop_de_avg_degree))  #normal
#LOOP: angular error
normality_midlife_HP[13,] <-unlist(shapiro.test(midlife_HP_df$loop_ae_rad3_degree))  #normal
normality_midlife_HP[14,] <-unlist(shapiro.test(midlife_HP_female_df$loop_ae_rad3_degree))  #normal
normality_midlife_HP[15,] <-unlist(shapiro.test(midlife_HP_male_df$loop_ae_rad3_degree))  #normal
normality_midlife_HP[16,] <-unlist(shapiro.test(midlife_HP_df$loop_ae_avg_degree))  # notnormal
normality_midlife_HP[17,] <-unlist(shapiro.test(midlife_HP_female_df$loop_ae_avg_degree))  #notnormal
normality_midlife_HP[18,] <-unlist(shapiro.test(midlife_HP_male_df$loop_ae_avg_degree))  #no
loop_summarystats <- midlife_HP_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
#v contains adjusted hip
# 1 Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/midlife_HP_df$eTIV)
# 2 Let's correct by mutating the columns using the TIV from freesurfer
midlife_HP_df_adj <- midlife_HP_df %>% mutate_at(vars(avg_t1_hipp, `Left-Hippocampus`, `Right-Hippocampus`),
dividebyTIV) %>%
# multiplying to get proportions
mutate(avg_t1_hipp = avg_t1_hipp*100,
`Left-Hippocampus` = `Left-Hippocampus`*100,
`Right-Hippocampus` = `Right-Hippocampus`*100)
midlife_HP_female_df_adj <- midlife_HP_df_adj %>% filter(sex=="Female")
midlife_HP_male_df_adj <- midlife_HP_df_adj %>%  filter(sex== "Male")
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "Avg_PE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
midlife_HP_correlations <- data.frame(matrix(ncol=9, nrow=0))
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "Avg_PE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_rad3_m)) %>% mutate(analysis = "rad3_PE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_avg_degree)) %>% mutate(analysis = "avg_AE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_rad3_degree)) %>% mutate(analysis = "rad3_AE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_dg", y = "loop_de_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
ggscatter(midlife_HP_female_df_adj, x = "avg_t1_hipp", y = "estradiol_spatial_pg_ml",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Estradiol", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca23", y = "loop_de_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca23,midlife_HP_df_adj$loop_de_rad3_degree)) %>% mutate(analysis = "rad3_DT_T2CA23" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca23,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2CA23" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_dg,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2DG" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_dg,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2DG" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
ggscatter(midlife_HP_female_df_adj, x = "avg_t1_hipp", y = "estradiol_spatial_pg_ml",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Estradiol", ) +
theme(legend.position = "top", legend.title=element_blank())
broom::tidy(cor.test(midlife_HP_female_df_adj$avg_t1_hipp,midlife_HP_female_df_adj$estradiol_spatial_pg_ml, method = "spearman"))
nrow(midlife_HP_df_adj)
View(midlife_HP_female_df)
View(midlife_HP_female_df_adj)
nrow(midlife_HP_female_df_adj)
x <- midlife_HP_df_adj %>% filter(!is.na(t2hipp_vol_avg_dg))
View(x)
x <- midlife_HP_female_df_adj %>% filter(!is.na(t2hipp_vol_avg_dg))
View(x)
View(LOOP_raw_df)
View(midlife_HP_df)
View(loop_summarystats)
yng_summary <- as.data.frame(matrix(ncol = 3, nrow = 5)) %>% `colnames<-`(c("young female", "Young male", "Total"))
yng_summary <- as.data.frame(matrix(ncol = 4, nrow = 5)) %>% `colnames<-`(c("Analysis","young female", "Young male", "Total"))
View(yng_summary)
View(yng_summary)
