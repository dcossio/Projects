View(ALL_loop_summarystats)
ggboxplot(LOOP_raw_df, x = "age_group", y = "loop_de_avg_degree", color = "supp",
palette = c("#00AFBB", "#E7B800"))
ggboxplot(LOOP_raw_df, x = "age_group", y = "loop_de_avg_degree", color = "supp",
palette = c("#00AFBB", "#E7B800"))
ggboxplot(LOOP_raw_df, x = "age_group", y = "loop_de_avg_degree", color = "sex",
palette = c("#00AFBB", "#E7B800"))
DT_aov <- aov(loop_de_avg_degree ~ age_group + sex, data =LOOP_raw_df )
DT_aov <- aov(loop_de_avg_degree ~ age_group + sex, data =LOOP_raw_df )
summary(DT_aov)
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
knitr::kable(ALL_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
DT_aov <- aov(loop_de_avg_degree ~ age_group + sex, data =LOOP_raw_df )
summary(DT_aov)
library(ggplot2)
library(tidyverse)
library(stringr)
library(kableExtra)
# library(tidygraph)
# library(plotly)
#library(factoextra)
#library(lsr)
library(ggpubr)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(gridExtra)
library(markdown)
library(psych)
library(ppcor)
AE_aov <- aov(loop_ae_avg_degree ~ age_group + sex, data =LOOP_raw_df )
summary(AE_aov)
AE_aov <- aov(loop_ae_avg_degree ~ age_group + sex, data =LOOP_raw_df )
summary(AE_aov)
LOOP_raw_df$loop_ae_avg_degree
AE_aov <- aov(loop_ae_avg_degree ~ age_group + sex, data =LOOP_raw_df )
summary(AE_aov)
library(ggplot2)
library(tidyverse)
library(stringr)
library(kableExtra)
# library(tidygraph)
# library(plotly)
#library(factoextra)
#library(lsr)
library(ggpubr)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(gridExtra)
library(markdown)
library(psych)
library(ppcor)
workingdir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/LOOP"
#workingdir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/LOOP"
LOOP_raw_df <- read_csv(paste0(workingdir,"/LOOP_all_data.csv")) %>%  filter(loop_useable=="Yes")
midlife_raw_df <- LOOP_raw_df %>% filter(age_group=="Midlife")  %>% filter(subject_id != 372) # Excluding these 372 because they had a brain worm or something  #53
midlife_female_raw_df <- midlife_raw_df %>% filter(sex=="Female")
midlife_male_raw_df <- midlife_raw_df %>% filter(sex=="Male")
young_raw_df <- LOOP_raw_df %>% filter(age_group=="Young") %>% filter(completed_scan == "Yes") # Making sure we only use scan subjects N= 32
ALL_loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
https://uci.zoom.us/j/98948093365
ALL_loop_summarystats
yng_loop_summarystats <- LOOP_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(yng_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
yng_loop_summarystats <- young_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(yng_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
mid_loop_summarystats <- midlife_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(yng_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
midL_loop_summarystats <- midlife_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
mid_loop_summarystats <- midlife_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(midL_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
View(midlife_raw_df)
View(young_raw_df)
DT_aov <- aov(loop_de_avg_degree ~ age_group + sex, data =LOOP_raw_df )
summary(DT_aov)
DT_aov <- aov(loop_de_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(DT_aov)
DT_aov <- aov(loop_de_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(DT_aov)
AE_aov <- aov(loop_ae_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(AE_aov)
AE_aov <- aov(loop_ae_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(AE_aov)
DT_aov <- aov(loop_de_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(DT_aov)
View(young_raw_df)
View(LOOP_raw_df)
young_raw_df <- LOOP_raw_df %>% filter(age_group=="Young")
yng_loop_summarystats <- young_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(yng_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
mid_loop_summarystats <- midlife_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(midL_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
knitr::kable(mid_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
AE_aov <- aov(loop_ae_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(AE_aov)
View(AE_aov)
AE_aov[["coefficients"]]
AE_aov[["model"]]
View(LOOP_raw_df)
View(midlife_raw_df)
AE_aov <- aov(loop_ae_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(AE_aov)
AE_aov <- aov(loop_ae_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(AE_aov)
DT_aov <- aov(loop_de_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(DT_aov)
library(ggplot2)
library(tidyverse)
library(stringr)
library(kableExtra)
# library(tidygraph)
# library(plotly)
#library(factoextra)
#library(lsr)
library(ggpubr)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(gridExtra)
library(markdown)
library(psych)
library(ppcor)
workingdir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/LOOP"
#workingdir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/LOOP"
LOOP_raw_df <- read_csv(paste0(workingdir,"/LOOP_all_data.csv")) %>%  filter(loop_useable=="Yes")
midlife_raw_df <- LOOP_raw_df %>% filter(age_group=="Midlife")  %>% filter(subject_id != 372) # Excluding these 372 because they had a brain worm or something  #53
midlife_female_raw_df <- midlife_raw_df %>% filter(sex=="Female")
midlife_male_raw_df <- midlife_raw_df %>% filter(sex=="Male")
young_raw_df <- LOOP_raw_df %>% filter(age_group=="Young")
yng_loop_summarystats <- young_raw_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n = n(),
mean_age = mean(age_spatial_years),
SD_age = sd(age_spatial_years),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = mean(loop_ae_avg_degree ,na.rm=TRUE),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n = n(),
mean_age = mean(age_spatial_years),
SD_age = sd(age_spatial_years),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = mean(loop_ae_avg_degree ,na.rm=TRUE),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n = n(),
`Mean Age` = mean(age_spatial_years),
SD = sd(age_spatial_years),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = mean(loop_ae_avg_degree ,na.rm=TRUE),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n = n(),
`Mean Age` = round(mean(age_spatial_years)),
SD = round(sd(age_spatial_years)),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = mean(loop_ae_avg_degree ,na.rm=TRUE),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n = n(),
`Mean Age` = round(mean(age_spatial_years), digits = 2),
SD = round(sd(age_spatial_years)),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = mean(loop_ae_avg_degree ,na.rm=TRUE),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
loop_summarystats <- LOOP_raw_df  %>%
group_by(age_group) %>%
summarize(n = n(),
`Mean Age` = round(mean(age_spatial_years), digits = 2),
SD = round(sd(age_spatial_years), digits = 2),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = round(mean(loop_ae_avg_degree ,na.rm=TRUE), digits = 2),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = round(mean(loop_de_avg_degree,na.rm=TRUE), digits = 2)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
mid_loop_summarystats <- midlife_raw_df  %>%
group_by(sex) %>%
summarize(
n = n(),
`Mean Age` = round(mean(age_spatial_years), digits = 2),
SD = round(sd(age_spatial_years), digits = 2),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = round(mean(loop_ae_avg_degree , na.rm = TRUE), digits = 2),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = round(mean(loop_de_avg_degree, na.rm =TRUE), digits = 2)) %>% as.data.frame()
knitr::kable(mid_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
loop_summarystats <- LOOP_raw_df  %>%
group_by(sex) %>%
summarize(
n = n(),
`Mean Age` = round(mean(age_spatial_years), digits = 2),
SD = round(sd(age_spatial_years), digits = 2),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = round(mean(loop_ae_avg_degree , na.rm = TRUE), digits = 2),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = round(mean(loop_de_avg_degree, na.rm =TRUE), digits = 2)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
DT_aov <- aov(loop_de_avg_degree ~ age_group * sex, data =LOOP_raw_df )
summary(DT_aov)
# Let's create a clean df to work with here and include only the columns we want
midlife_HP_df <-
midlife_raw_df %>%  dplyr::select(
"subject_id",
"sex",
"age_spatial_years",
"repo_status",
"loop_pe_rad3_m",
"loop_pe_avg_m",
"loop_de_rad3_degree",
"loop_de_avg_degree",
"loop_ae_rad3_degree",
"loop_ae_avg_degree",
"t1_vbm_tiv",
"t1_vbm_gmv",
"t1_vbm_wmv",
"t1_vbm_csf",
"t1_vol_left_hipp_aal_2d_d1_r",
"t1_vol_right_hipp_aal_2d_d1_r",
"t1_vol_left_hipp_aal_3d_d1_s",
"t1_vol_right_hipp_aal_3d_d1_s",
"t2hipp_vol_avg_ca1",
"t2hipp_vol_avg_ca23",
"t2hipp_vol_avg_dg",
"t2hipp_vol_avg_erc",
"t2hipp_vol_avg_phc",
"t2hipp_vol_avg_prc",
"t2hipp_vol_avg_sub",
"t2hipp_vol_left_ca1" ,
"t2hipp_vol_left_ca23",
"t2hipp_vol_left_dg",
"t2hipp_vol_left_erc",
"t2hipp_vol_left_phc",
"t2hipp_vol_left_prc",
"t2hipp_vol_left_sub"  ,
"t2hipp_vol_right_ca1",
"t2hipp_vol_right_ca23",
"t2hipp_vol_right_dg",
"t2hipp_vol_right_prc",
"t2hipp_vol_right_sub",
"Left-Hippocampus",
"Right-Hippocampus",
"eTIV",
"estradiol_scan_pg_ml",
"progesterone_scan_ng_ml",
"fsh_scan_miu_ml",
"shbg_scan_nmol_l",
"dheas_scan_ug_dl",
"testosterone_scan_ng_dl",
"estradiol_spatial_pg_ml",
"progesterone_spatial_ng_ml",
"fsh_spatial_miu_ml",
"shbg_spatial_nmol_l",
"dheas_spatial_ug_dl",
"testosterone_spatial_ng_dl"
) %>% mutate(avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) /
2) %>% filter(!is.na(eTIV)) %>% mutate(
avg_t2_total_hipp = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub,
left_t2_total_hipp = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub,
right_t2_total_hipp = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub
)  # N=43
midlife_HP_female_df <- midlife_HP_df %>% filter(sex=="Female")
midlife_HP_male_df <- midlife_HP_df %>%  filter(sex== "Male")
View(midlife_HP_df)
hp_loop_summarystats <- midlife_HP_df  %>%
group_by(sex) %>%
summarize(n_subject = n(),
age_mean = mean(age_spatial_years),
age_Sd = sd(age_spatial_years),
AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame()
#v contains adjusted hip
# 1 Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/midlife_HP_df$eTIV)
# 2 Let's correct by mutating the columns using the TIV from freesurfer
midlife_HP_df_adj <- midlife_HP_df %>% mutate_at(vars(avg_t1_hipp, `Left-Hippocampus`, `Right-Hippocampus`),
dividebyTIV) %>%
# multiplying to get proportions
mutate(avg_t1_hipp = avg_t1_hipp*1000,
`Left-Hippocampus` = `Left-Hippocampus`*1000,
`Right-Hippocampus` = `Right-Hippocampus`*1000)
midlife_HP_female_df_adj <- midlife_HP_df_adj %>% filter(sex=="Female")
midlife_HP_male_df_adj <- midlife_HP_df_adj %>%  filter(sex== "Male")
midlife_HP_correlations <- data.frame(matrix(ncol=9, nrow=0))
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_avg_degree, method = "spearman")) %>% mutate(analysis = "Avg_AE_T1total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
x
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_ae_avg_degree, method = "spearman")) %>% mutate(analysis = "Avg_AE_T2total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
shapiro.test(midlife_HP_df_adj$loop_ae_avg_degree)
View(x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2total" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
View(x)
View(x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca1,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2CA1" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca1,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2CA1" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca23,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2CA23" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_dg,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2DG" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_dg,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2DG" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
View(x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_sub,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2sub" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_erc,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2ERC" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
View(x)
loop_summarystats <- LOOP_raw_df  %>%
group_by(sex) %>%
summarize(
n = n(),
`Mean Age` = round(mean(age_spatial_years), digits = 2),
SD = round(sd(age_spatial_years), digits = 2),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = round(mean(loop_ae_avg_degree , na.rm = TRUE), digits = 2),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = round(mean(loop_de_avg_degree, na.rm =TRUE), digits = 2)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
loop_summarystats <- LOOP_raw_df  %>%
group_by(sex) %>%
summarize(
n = n(),
`Mean Age` = round(mean(age_spatial_years), digits = 2),
SD = round(sd(age_spatial_years), digits = 2),
#AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
`Angular Error` = round(mean(loop_ae_avg_degree , na.rm = TRUE), digits = 2),
AE_SD = round(sd(loop_ae_avg_degree), digits = 2),
#PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
#PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
#DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
`Degrees Traveled` = round(mean(loop_de_avg_degree, na.rm =TRUE), digits = 2),
DT_SD = round(sd(loop_ae_avg_degree), digits = 2)) %>% as.data.frame()
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")
