---
title: "LOOP Notes and Analyses"
author: "Daniela Cossio"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
    html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    classoption:
    - twocolumn
---

```{r adding libraries,echo=FALSE, results='hide',message=FALSE}
library(ggplot2)
library(tidyverse)
library(stringr)
library(kableExtra)
# library(tidygraph)
# library(plotly)
#library(factoextra)
#library(lsr)
library(ggpubr)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(gridExtra)
library(markdown)
library(psych)
library(ppcor)
```



```{css, echo=FALSE}
TOC {
  color: #F6B2DB;
  font-family: Arial;
  font-size: "16px"; 
  border-color: #F6B2DB;
}

h1.title {
  color: black ;
  font-family: Arial;
  font-size: "72px";
  padding: "10px 0";
  background-color: #F6B2DB ;
  text-align: center;
}

h4.date {
  color: black ;
  font-family: Arial;
  font-size: "34px";
  text-align: center;
}

h4.author {
  color: black;
  font-size: "34px";
  font-family: Arial;
  text-align: center;
}


h1,h2, h3, h4, h5 ,h6 {
  text-align: center;
  font-family: Arial;
  
}

body, p, h2{
  color: black; 
  font-family: Arial;
}

hr {
  height:5px;
  border-width:0;
  background-color: black ;
}



```

# **Overview** 

This is a combination of these analyses used for loop. Code is a combination of Daniela and Shuyings code. Might add Nicks later

Below is a list of sections included here. Including summaries of the white matter analyses and completed figures. 

* Behavior
* Hormones Analyses
* Hippocampal Subfield 
* Cortical Thickness  
    * My general hypothesis is going to be focused on general somatosensory regions and the dorsal attention network. General approach : for the Schaefar atlas is to take the average for each ROI network and not do each individual parcellation.Do correlation between each parcellation and variable and then average by network. 
    
<br>

* Diffusion Summary (no analyses)

<br>

<hr>

# Methods {.tabset .tabset-pills}
## Behavior 
* group differences?

## Hormones

Shapiro-Wilk normality tests were conducted to assess violations of normality of the independent and dependent variables before conducting correlations between spatial navigation dependent variables and sex hormones. To control for chronological age while assessing the relationship between sex steroid hormones and navigational strategy, partial Spearman rank correlations were conducted if the Shapiro-Wilk normality tests were statistically significant (p < 0.05); otherwise, Pearson correlations were conducted. Based on existing evidence of sex hormones’ influence on navigation from the animal literature and strong a priori predictions that estradiol would be positively associated with navigation performance, and follicle-stimulating hormone would show an opposing effect, we conducted one-tailed analyses for these tests, controlling for chronological age. Two-tailed analyses were used for hormones without a strong a priori hypothesis (progesterone, testosterone). Men and women were analyzed separately. For men, we conducted a one-tailed correlation for testosterone to be in the positive direction, while we conducted a two-tailed correlation for testosterone for women. 

## Hippocampal Subfields

** notes as of 2025 **
- T1 HP volume extracted using freesurfer recon all.
- Corrected using TIV from free surfer 

Total hippocampus (from T1-weighted whole brain scans) and hippocampal subfield volumes were corrected using participant’s total intracranial volume (TIV) to remove size
Figure 4.1. Investigating volumetric differences using segmentation of the medial temporal lobe and total hippocampus region. (A) Sample slice of the medial temporal lobe cortex and hippocampus segmented into hippocampal subfields using the Automatic Segmentation of Hippocampal Subfields software. Labeled subfields include: CA1 (cornu ammonis), CA2/3, DG (dentate gyrus), SUB (subiculum), ERC (entorhinal cortex), PRC (perirhinal cortex), and PHC (parahippocampal cortex). Total hippocampus is computed by aggregating subfields CA1, CA2/3, DG, and SUB. Medial temporal lobe is computed by aggregating all the subfields. (B) Women (n = 74, M = 0.56) tend to have larger T1 total hippocampal volume than men (n = 32, M = 0.48; t(68) = 9.72, p < 0.001). Boxplot endpoints indicate the 25th and 75th percentile, and the black line within the boxplot indicates the median value while the black point within the boxplot indicates the mean value. p-values: *** p < 0.001.
<br> 

bias in comparisons. In addition to the total hippocampal volume from the T1-weighted scans, another measure of total hippocampal volume from the T2-weighted hippocampal subfield scans was calculated by taking the sum of the CA1, CA2/3, dentate gyrus, and subiculum subfield volumes after adjusted for TIV. These structures make up the hippocampus region based on the anatomical components of the medial temporal lobe system (Squire et al., 2004; Squire & Zola-Morgan, 1991). An average of the left and right grey matter volume (mm3) for the total hippocampus and the individual subfields was used for analysis. For all the statistical tests mentioned, corrections for multiple comparisons were performed using Benjamini, Hochberg, and Yekutieli p-adjustments to control the false discovery rate.

<hr>


## Cortical Thickness

* Conduct Spearman correlations
* Benjamini Hotchkins control
* Going to try Q value control


## Diffusion




# Reading in and prepping our data 

** Reading in our main LOOP CSV and creating large dataframes for midlife and young 

```{r reading in our CSVs, echo=FALSE, results='hide',message=FALSE}
workingdir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/LOOP"

LOOP_raw_df <- read_csv(paste0(workingdir,"/LOOP_all_data.csv"))

midlife_raw_df <- LOOP_raw_df %>% filter(age_group=="Midlife")  %>% filter(subject_id != 372) # Excluding these 372 because they had a brain worm or something  #53

midlife_female_raw_df <- midlife_raw_df %>% filter(sex=="Female")

midlife_male_raw_df <- midlife_raw_df %>% filter(sex=="Male")
  
young_raw_df <- LOOP_raw_df %>% filter(age_group=="Young") %>% filter(completed_scan == "Yes") # Making sure we only use scan subjects N= 32 

```



# Hippocampal Analyses

# Midlife 

## List of columns  

The list below are from shuyings original raw data. We will ignore the old T1.
The T2 here are already corrected for TIV. 

```{r,echo=FALSE,message=FALSE,collapse = TRUE}
data.frame(c(
    "t1_vbm_tiv",
    "t1_vbm_gmv",
    "t1_vbm_wmv",
    "t1_vbm_csf",
    "t1_vol_left_hipp_aal_2d_d1_r",
    "t1_vol_right_hipp_aal_2d_d1_r",
    "t1_vol_left_hipp_aal_3d_d1_s",
    "t1_vol_right_hipp_aal_3d_d1_s",
    "t2hipp_vol_avg_ca1",
    "t2hipp_vol_avg_ca23",
    "t2hipp_vol_avg_dg",
    "t2hipp_vol_avg_erc",
    "t2hipp_vol_avg_phc",
    "t2hipp_vol_avg_prc",
    "t2hipp_vol_avg_sub",
    "t2hipp_vol_left_ca1" ,
    "t2hipp_vol_left_ca23",
    "t2hipp_vol_left_dg",
    "t2hipp_vol_left_erc",
    "t2hipp_vol_left_phc",
    "t2hipp_vol_left_prc",
    "t2hipp_vol_left_sub"  ,
    "t2hipp_vol_right_ca1",
    "t2hipp_vol_right_ca23",
    "t2hipp_vol_right_dg",
    "t2hipp_vol_right_prc",
    "t2hipp_vol_right_sub")) %>% `colnames<-`("columns") %>% kable() %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")

```

## Creating HP specific Dataframe : midlife_HP_df

Total N - 43 
    
    
```{r,collapse = TRUE}
# Let's create a clean df to work with here and include only the columns we want 

midlife_HP_df <-
  midlife_raw_df %>%  dplyr::select(
    "subject_id",
    "sex",
    "age_spatial_years",
    "repo_status",
    "loop_pe_rad3_m",
    "loop_pe_avg_m",
    "loop_de_rad3_degree",
    "loop_de_avg_degree",
    "loop_ae_rad3_degree",
    "loop_ae_avg_degree",
    "t1_vbm_tiv",
    "t1_vbm_gmv",
    "t1_vbm_wmv",
    "t1_vbm_csf",
    "t1_vol_left_hipp_aal_2d_d1_r",
    "t1_vol_right_hipp_aal_2d_d1_r",
    "t1_vol_left_hipp_aal_3d_d1_s",
    "t1_vol_right_hipp_aal_3d_d1_s",
    "t2hipp_vol_avg_ca1",
    "t2hipp_vol_avg_ca23",
    "t2hipp_vol_avg_dg",
    "t2hipp_vol_avg_erc",
    "t2hipp_vol_avg_phc",
    "t2hipp_vol_avg_prc",
    "t2hipp_vol_avg_sub",
    "t2hipp_vol_left_ca1" ,
    "t2hipp_vol_left_ca23",
    "t2hipp_vol_left_dg",
    "t2hipp_vol_left_erc",
    "t2hipp_vol_left_phc",
    "t2hipp_vol_left_prc",
    "t2hipp_vol_left_sub"  ,
    "t2hipp_vol_right_ca1",
    "t2hipp_vol_right_ca23",
    "t2hipp_vol_right_dg",
    "t2hipp_vol_right_prc",
    "t2hipp_vol_right_sub",
    "Left-Hippocampus",
    "Right-Hippocampus",
    "eTIV"
  ) %>% mutate(avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) /
                 2) %>% filter(!is.na(eTIV)) # Need to make sure we remove subj without scan # N=43
  
midlife_HP_female_df <- midlife_HP_df %>% filter(sex=="Female")

midlife_HP_male_df <- midlife_HP_df %>%  filter(sex== "Male")
 
```

## Checking normality

- Degrees traveled for all midlife is not normally distributed (p=0.04) and degrees traveled for men only ( p = 0.0001979)
- Position error was normally distributed for all groups 
- Angular error rad3 was normally distributed for alll groups
-  Angular error average for midlife was not normally distributed (p = 0.0007472) and it was not normally distributed for women only ( p-value = 0.004246)
```{r, echo=FALSE,message=FALSE}


#Creating an empty table to put everything in
normality_midlife_HP <- data.frame(matrix(ncol = 4, nrow = 0)) %>% `colnames<-`(c("statistic", "pvalue", "method", "variable"))

#LOOP: position error
normality_midlife_HP[1,] <- unlist(shapiro.test(midlife_HP_df$loop_pe_rad3_m)) #normal
normality_midlife_HP[2,] <- unlist(shapiro.test(midlife_HP_female_df$loop_pe_rad3_m)) #normal
normality_midlife_HP[3,] <- unlist(shapiro.test(midlife_HP_male_df$loop_pe_rad3_m)) #normal

#LOOP: position error average
normality_midlife_HP[4,] <-unlist(shapiro.test(midlife_HP_df$loop_pe_avg_m)) #normal
normality_midlife_HP[5,] <-unlist(shapiro.test(midlife_HP_female_df$loop_pe_avg_m)) #normal
normality_midlife_HP[6,] <-unlist(shapiro.test(midlife_HP_male_df$loop_pe_avg_m)) #normal

#LOOP: degrees traveled
normality_midlife_HP[7,] <-unlist(shapiro.test(midlife_HP_df$loop_de_rad3_degree))  #notnormal
normality_midlife_HP[8,] <-unlist(shapiro.test(midlife_HP_female_df$loop_de_rad3_degree))  #normal
normality_midlife_HP[9,] <-unlist(shapiro.test(midlife_HP_male_df$loop_de_rad3_degree) ) #notnormal

normality_midlife_HP[10,] <-unlist(shapiro.test(midlife_HP_df$loop_de_avg_degree))  #normal 
normality_midlife_HP[11,] <-unlist(shapiro.test(midlife_HP_female_df$loop_de_avg_degree))  #normal
normality_midlife_HP[12,] <-unlist(shapiro.test(midlife_HP_male_df$loop_de_avg_degree))  #normal


#LOOP: angular error
normality_midlife_HP[13,] <-unlist(shapiro.test(midlife_HP_df$loop_ae_rad3_degree))  #normal
normality_midlife_HP[14,] <-unlist(shapiro.test(midlife_HP_female_df$loop_ae_rad3_degree))  #normal
normality_midlife_HP[15,] <-unlist(shapiro.test(midlife_HP_male_df$loop_ae_rad3_degree))  #normal

normality_midlife_HP[16,] <-unlist(shapiro.test(midlife_HP_df$loop_ae_avg_degree))  # notnormal
normality_midlife_HP[17,] <-unlist(shapiro.test(midlife_HP_female_df$loop_ae_avg_degree))  #notnormal
normality_midlife_HP[18,] <-unlist(shapiro.test(midlife_HP_male_df$loop_ae_avg_degree))  #no


```

```{r}
knitr::kable(normality_midlife_HP) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "300px")
```


<br>
<br>

## Behavior summarized


```{r}
loop_summarystats <- midlife_HP_df  %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years),
            AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
            AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
            PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
            PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
            DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
            DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame() 
```

```{r}
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")

```

## T1 Correlations

## Shuyings code

Shuying originally did an adjustment. so that's waht we're doing below. First we need to correct the T1 hippocampal volumes for TIV. T1 volumes and TIV are coming from freesurfers recon all. 
```{r, Correct for T1v}

#v contains adjusted hip
# 1 Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/midlife_HP_df$eTIV)

# 2 Let's correct by mutating the columns using the TIV from freesurfer

midlife_HP_df_adj <- midlife_HP_df %>% mutate_at(vars(avg_t1_hipp, `Left-Hippocampus`, `Right-Hippocampus`),
            dividebyTIV) %>% 
  
  # multiplying to get proportions 
   mutate(avg_t1_hipp = avg_t1_hipp*1000,
         `Left-Hippocampus` = `Left-Hippocampus`*1000,
         `Right-Hippocampus` = `Right-Hippocampus`*1000)

```


Now that things have been adjusted I need to do correlations
### Total HP

** position Error **

- Position error avg is not significantly associated with t1 total hippocampus R=0.22, p=0.15
```{r, average t1 adjusts and position error average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_avg_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Position error rad3 is not significantly associated with t1 total hippocampus R=0.11, p=0.152

```{r, average t1 adjusts and position error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_rad3_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<bhr>

** Angular Error**

- Angular error is not significantly associated with t1 total hippocampus R=0.29, p=0.058

```{r, average t1 adjusts and angular error average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Angular error is not significantly associated with t1 total hippocampus R=0.1, p=0.054

```{r, average t1 adjusts and angular error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

** Degrees Traveled **

- Degrees Traveled  is not significantly associated with t1 total hippocampus R=-0.17, p=0.28

```{r, average t1 adjusts and DT average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- degrees traveled is not significantly associated with t1 total hippocampus R=-0.079, p=0.63

```{r, average t1 adjusts and degrees traveled error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled at 3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```



## Partial correlations using TIV as covariate

## Total hp

** Position Error **
- Position error is not significantly associated with t1 total hippocampus R=-0.63, p=0.53
```{r, average t1 covariate and position error average}
# Use hp data frame adjusted 
pcor.test(midlife_HP_df$loop_pe_avg_m, midlife_HP_df$avg_t1_hipp, midlife_HP_df$eTIV)

```

- Position error rad3  is not significantly associated with t1 total hippocampus R=-0.87, p=0.39
```{r, average t1 covariate and position error rad3}
# Use hp data frame adjusted 
midlife_hp_rad3 <- midlife_HP_df %>% filter(!is.na(loop_pe_rad3_m))
pcor.test(midlife_hp_rad3$loop_pe_rad3_m, midlife_hp_rad3$avg_t1_hipp, midlife_hp_rad3$eTIV)

```

<br>

** Angular Error **

- Angular error is not significantly associated with t1 total hippocampus R=-0.36, p=0.72
```{r, average t1 covariate and angular error average}
# Use hp data frame adjusted 
pcor.test(midlife_HP_df$loop_ae_avg_degree, midlife_HP_df$avg_t1_hipp, midlife_HP_df$eTIV)

```

- angular error rad3  is not significantly associated with t1 total hippocampus R=-0.9, p=0.37
```{r, average t1 covariate and angular error rad3}
# Use hp data frame adjusted 
midlife_hp_rad3 <- midlife_HP_df %>% filter(!is.na(loop_ae_rad3_degree))
pcor.test(midlife_hp_rad3$loop_ae_rad3_degree, midlife_hp_rad3$avg_t1_hipp, midlife_hp_rad3$eTIV)

```

** Degrees Traveled  **

- Degrees Traveled is not significantly associated with t1 total hippocampus R=-0.94, p=0.35
```{r, average t1 covariate and Degrees Traveled average}
# Use hp data frame adjusted 
pcor.test(midlife_HP_df$loop_de_avg_degree, midlife_HP_df$avg_t1_hipp, midlife_HP_df$eTIV)

```

-Degrees Traveled rad3  is not significantly associated with t1 total hippocampus R= -0.96, p=0.34
```{r, average t1 covariate and Degrees Traveled rad3}
# Use hp data frame adjusted 
midlife_hp_rad3 <- midlife_HP_df %>% filter(!is.na(loop_de_rad3_degree))
pcor.test(midlife_hp_rad3$loop_de_rad3_degree, midlife_hp_rad3$avg_t1_hipp, midlife_hp_rad3$eTIV)

```

# Young

## Creating HP specific Dataframe : midlife_HP_df

Total N - 43 
    
    
```{r,collapse = TRUE}
# Let's create a clean df to work with here and include only the columns we want 

young_HP_df <-
 young_raw_df %>%  dplyr::select(
    "subject_id",
    "sex",
    "age_spatial_years",
    "loop_pe_rad3_m",
    "loop_pe_avg_m",
    "loop_de_rad3_degree",
    "loop_de_avg_degree",
    "loop_ae_rad3_degree",
    "loop_ae_avg_degree",
    "Left-Hippocampus",
    "Right-Hippocampus",
    "eTIV"
  ) %>% mutate(avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) /
                 2) %>% filter(!is.na(eTIV)) # Need to make sure we remove subj without scan # N=43
  
young_HP_female_df <- young_HP_df %>% filter(sex=="Female")

young_HP_male_df <- young_HP_df %>%  filter(sex== "Male")
 
```

## Checking normality


```{r, echo=FALSE,message=FALSE}


#Creating an empty table to put everything in
normality_young_HP <- data.frame(matrix(ncol = 4, nrow = 0)) %>% `colnames<-`(c("statistic", "pvalue", "method", "variable"))

#LOOP: position error
normality_young_HP[1,] <- unlist(shapiro.test(young_HP_df$loop_pe_rad3_m)) #normal
normality_young_HP[2,] <- unlist(shapiro.test(young_HP_female_df$loop_pe_rad3_m)) #normal
normality_young_HP[3,] <- unlist(shapiro.test(young_HP_male_df$loop_pe_rad3_m)) #normal

#LOOP: position error average
normality_young_HP[4,] <-unlist(shapiro.test(young_HP_df$loop_pe_avg_m)) #normal
normality_young_HP[5,] <-unlist(shapiro.test(young_HP_female_df$loop_pe_avg_m)) #normal
normality_young_HP[6,] <-unlist(shapiro.test(young_HP_male_df$loop_pe_avg_m)) #normal

#LOOP: degrees traveled
normality_young_HP[7,] <-unlist(shapiro.test(young_HP_df$loop_de_rad3_degree))  #notnormal
normality_young_HP[8,] <-unlist(shapiro.test(young_HP_female_df$loop_de_rad3_degree))  #normal
normality_young_HP[9,] <-unlist(shapiro.test(young_HP_male_df$loop_de_rad3_degree) ) #notnormal

normality_young_HP[10,] <-unlist(shapiro.test(young_HP_df$loop_de_avg_degree))  #normal 
normality_young_HP[11,] <-unlist(shapiro.test(young_HP_female_df$loop_de_avg_degree))  #normal
normality_young_HP[12,] <-unlist(shapiro.test(young_HP_male_df$loop_de_avg_degree))  #normal


#LOOP: angular error
normality_young_HP[13,] <-unlist(shapiro.test(young_HP_df$loop_ae_rad3_degree))  #normal
normality_young_HP[14,] <-unlist(shapiro.test(young_HP_female_df$loop_ae_rad3_degree))  #normal
normality_young_HP[15,] <-unlist(shapiro.test(young_HP_male_df$loop_ae_rad3_degree))  #normal

normality_young_HP[16,] <-unlist(shapiro.test(young_HP_df$loop_ae_avg_degree))  # notnormal
normality_young_HP[17,] <-unlist(shapiro.test(young_HP_female_df$loop_ae_avg_degree))  #notnormal
normality_young_HP[18,] <-unlist(shapiro.test(young_HP_male_df$loop_ae_avg_degree))  #no


```

```{r}
knitr::kable(normality_young_HP) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "300px")
```


<br>
<br>