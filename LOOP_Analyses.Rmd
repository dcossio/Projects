---
title: "LOOP Notes and Analyses"
author: "Daniela Cossio"
date: "`r format(Sys.time(), '%d %B %Y')`"
output:
    html_document:
    toc: true
    toc_float: true
    toc_depth: 2
    classoption:
    - twocolumn
---

```{r adding libraries,echo=FALSE, results='hide',message=FALSE}
library(ggplot2)
library(tidyverse)
library(stringr)
library(kableExtra)
# library(tidygraph)
# library(plotly)
#library(factoextra)
#library(lsr)
library(ggpubr)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(gridExtra)
library(markdown)
library(psych)
library(ppcor)
```



```{css, echo=FALSE}
TOC {
  color: #F6B2DB;
  font-family: Arial;
  font-size: "16px"; 
  border-color: #F6B2DB;
}

h1.title {
  color: black ;
  font-family: Arial;
  font-size: "72px";
  padding: "10px 0";
  background-color: #F6B2DB ;
  text-align: center;
}

h4.date {
  color: black ;
  font-family: Arial;
  font-size: "34px";
  text-align: center;
}

h4.author {
  color: black;
  font-size: "34px";
  font-family: Arial;
  text-align: center;
}


h1,h2, h3, h4, h5 ,h6 {
  text-align: center;
  font-family: Arial;
  
}

body, p, h2{
  color: black; 
  font-family: Arial;
}

hr {
  height:5px;
  border-width:0;
  background-color: black ;
}



```

# **Overview** 

This is a combination of these analyses used for loop. Code is a combination of Daniela and Shuyings code. Might add Nicks later

Below is a list of sections included here. Including summaries of the white matter analyses and completed figures. 

<!-- ```{r, Creating a table to summarize Ns for analyses} -->

<!-- yng_summary <- as.data.frame(matrix(ncol = 4, nrow = 5)) %>% `colnames<-`(c("Analysis","young female", "Young male", "Total")) -->


<!-- yng_summary$Analysis[,1:5] <- c("Diffusion",) -->


<!-- ``` -->


* Behavior
* Hormones Analyses
* Hippocampal Subfield 
* Cortical Thickness  
    * My general hypothesis is going to be focused on general somatosensory regions and the dorsal attention network. General approach : for the Schaefar atlas is to take the average for each ROI network and not do each individual parcellation.Do correlation between each parcellation and variable and then average by network. 
    
<br>

* Diffusion Summary (no analyses)

<br>

<hr>

# Methods {.tabset .tabset-pills}
## Behavior 
* group differences?

## Hormones

Shapiro-Wilk normality tests were conducted to assess violations of normality of the independent and dependent variables before conducting correlations between spatial navigation dependent variables and sex hormones. To control for chronological age while assessing the relationship between sex steroid hormones and navigational strategy, partial Spearman rank correlations were conducted if the Shapiro-Wilk normality tests were statistically significant (p < 0.05); otherwise, Pearson correlations were conducted. Based on existing evidence of sex hormones’ influence on navigation from the animal literature and strong a priori predictions that estradiol would be positively associated with navigation performance, and follicle-stimulating hormone would show an opposing effect, we conducted one-tailed analyses for these tests, controlling for chronological age. Two-tailed analyses were used for hormones without a strong a priori hypothesis (progesterone, testosterone). Men and women were analyzed separately. For men, we conducted a one-tailed correlation for testosterone to be in the positive direction, while we conducted a two-tailed correlation for testosterone for women. 

## Hippocampal Subfields

** notes as of 2025 **
- T1 HP volume extracted using freesurfer recon all.
- Corrected using TIV from free surfer 

Total hippocampus (from T1-weighted whole brain scans) and hippocampal subfield volumes were corrected using participant’s total intracranial volume (TIV) to remove size
Figure 4.1. Investigating volumetric differences using segmentation of the medial temporal lobe and total hippocampus region. (A) Sample slice of the medial temporal lobe cortex and hippocampus segmented into hippocampal subfields using the Automatic Segmentation of Hippocampal Subfields software. Labeled subfields include: CA1 (cornu ammonis), CA2/3, DG (dentate gyrus), SUB (subiculum), ERC (entorhinal cortex), PRC (perirhinal cortex), and PHC (parahippocampal cortex). Total hippocampus is computed by aggregating subfields CA1, CA2/3, DG, and SUB. Medial temporal lobe is computed by aggregating all the subfields. (B) Women (n = 74, M = 0.56) tend to have larger T1 total hippocampal volume than men (n = 32, M = 0.48; t(68) = 9.72, p < 0.001). Boxplot endpoints indicate the 25th and 75th percentile, and the black line within the boxplot indicates the median value while the black point within the boxplot indicates the mean value. p-values: *** p < 0.001.
<br> 

bias in comparisons. In addition to the total hippocampal volume from the T1-weighted scans, another measure of total hippocampal volume from the T2-weighted hippocampal subfield scans was calculated by taking the sum of the CA1, CA2/3, dentate gyrus, and subiculum subfield volumes after adjusted for TIV. These structures make up the hippocampus region based on the anatomical components of the medial temporal lobe system (Squire et al., 2004; Squire & Zola-Morgan, 1991). An average of the left and right grey matter volume (mm3) for the total hippocampus and the individual subfields was used for analysis. For all the statistical tests mentioned, corrections for multiple comparisons were performed using Benjamini, Hochberg, and Yekutieli p-adjustments to control the false discovery rate.

<hr>


## Cortical Thickness

* Conduct Spearman correlations
* Benjamini Hotchkins control
* Going to try Q value control


## Diffusion





<hr>
<br>

# Results {.tabset .tabset-pills}

## Reading in and prepping our data 

Reading in our main LOOP CSV and creating large dataframes for midlife and young

```{r reading in our CSVs, echo=FALSE, results='hide',message=FALSE}
workingdir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/LOOP"

#workingdir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/LOOP"

LOOP_raw_df <- read_csv(paste0(workingdir,"/LOOP_all_data.csv")) %>%  filter(loop_useable=="Yes")

midlife_raw_df <- LOOP_raw_df %>% filter(age_group=="Midlife")  %>% filter(subject_id != 372) # Excluding these 372 because they had a brain worm or something  #53

midlife_female_raw_df <- midlife_raw_df %>% filter(sex=="Female")

midlife_male_raw_df <- midlife_raw_df %>% filter(sex=="Male")
  
young_raw_df <- LOOP_raw_df %>% filter(age_group=="Young") %>% filter(completed_scan == "Yes") # Making sure we only use scan subjects N= 32 

```


<br>
<br>
<br>

## Behavior 


```{r}
ALL_loop_summarystats <- LOOP_raw_df  %>% 
  group_by(age_group) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years),
            AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
            AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
            PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
            PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
            DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
            DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame() 
```

```{r}
knitr::kable(ALL_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")

```

### ANOVA

SO no age effect but there is a sex effect essentially replicating what shuying found in her original analysis 
```{r, degrees traveled average }

DT_aov <- aov(loop_de_avg_degree ~ age_group + sex, data =LOOP_raw_df )

summary(DT_aov)
```

```{r}
ggboxplot(LOOP_raw_df, x = "age_group", y = "loop_de_avg_degree", color = "sex",
          palette = c("#00AFBB", "#E7B800"))
```

```{r, angular error average }

AE_aov <- aov(loop_ae_avg_degree ~ age_group + sex, data =LOOP_raw_df )

summary(AE_aov)
```

```{r, AE boxplot}
ggboxplot(LOOP_raw_df, x = "age_group", y = "loop_ae_avg_degree", color = "sex",
          palette = c("#00AFBB", "#E7B800"))
```
## Hippocampal Volume {.tabset .tabset-pills}

-  Need to figure out how many comparisons are included to use the BY correction

### Midlife {.tabset .tabset-pills}

#### List of columns  

The list below are from shuyings original raw data. We will ignore the old T1.
The T2 here are already corrected for TIV. 

```{r,echo=FALSE,message=FALSE,collapse = TRUE}
data.frame(c(
    "t1_vbm_tiv",
    "t1_vbm_gmv",
    "t1_vbm_wmv",
    "t1_vbm_csf",
    "t1_vol_left_hipp_aal_2d_d1_r",
    "t1_vol_right_hipp_aal_2d_d1_r",
    "t1_vol_left_hipp_aal_3d_d1_s",
    "t1_vol_right_hipp_aal_3d_d1_s",
    "t2hipp_vol_avg_ca1",
    "t2hipp_vol_avg_ca23",
    "t2hipp_vol_avg_dg",
    "t2hipp_vol_avg_erc",
    "t2hipp_vol_avg_phc",
    "t2hipp_vol_avg_prc",
    "t2hipp_vol_avg_sub",
    "t2hipp_vol_left_ca1" ,
    "t2hipp_vol_left_ca23",
    "t2hipp_vol_left_dg",
    "t2hipp_vol_left_erc",
    "t2hipp_vol_left_phc",
    "t2hipp_vol_left_prc",
    "t2hipp_vol_left_sub"  ,
    "t2hipp_vol_right_ca1",
    "t2hipp_vol_right_ca23",
    "t2hipp_vol_right_dg",
    "t2hipp_vol_right_prc",
    "t2hipp_vol_right_sub")) %>% `colnames<-`("columns") %>% kable() %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")

```

#### Creating HP specific Dataframe : midlife_HP_df

Total N - 43 
    
    
```{r, Creating cleaned DF to work from,collapse = TRUE}
# Let's create a clean df to work with here and include only the columns we want 


midlife_HP_df <-
  midlife_raw_df %>%  dplyr::select(
    "subject_id",
    "sex",
    "age_spatial_years",
    "repo_status",
    "loop_pe_rad3_m",
    "loop_pe_avg_m",
    "loop_de_rad3_degree",
    "loop_de_avg_degree",
    "loop_ae_rad3_degree",
    "loop_ae_avg_degree",
    "t1_vbm_tiv",
    "t1_vbm_gmv",
    "t1_vbm_wmv",
    "t1_vbm_csf",
    "t1_vol_left_hipp_aal_2d_d1_r",
    "t1_vol_right_hipp_aal_2d_d1_r",
    "t1_vol_left_hipp_aal_3d_d1_s",
    "t1_vol_right_hipp_aal_3d_d1_s",
    "t2hipp_vol_avg_ca1",
    "t2hipp_vol_avg_ca23",
    "t2hipp_vol_avg_dg",
    "t2hipp_vol_avg_erc",
    "t2hipp_vol_avg_phc",
    "t2hipp_vol_avg_prc",
    "t2hipp_vol_avg_sub",
    "t2hipp_vol_left_ca1" ,
    "t2hipp_vol_left_ca23",
    "t2hipp_vol_left_dg",
    "t2hipp_vol_left_erc",
    "t2hipp_vol_left_phc",
    "t2hipp_vol_left_prc",
    "t2hipp_vol_left_sub"  ,
    "t2hipp_vol_right_ca1",
    "t2hipp_vol_right_ca23",
    "t2hipp_vol_right_dg",
    "t2hipp_vol_right_prc",
    "t2hipp_vol_right_sub",
    "Left-Hippocampus",
    "Right-Hippocampus",
    "eTIV",
    "estradiol_scan_pg_ml",
    "progesterone_scan_ng_ml",
    "fsh_scan_miu_ml",
    "shbg_scan_nmol_l",
    "dheas_scan_ug_dl",
    "testosterone_scan_ng_dl",
    "estradiol_spatial_pg_ml",
    "progesterone_spatial_ng_ml",
    "fsh_spatial_miu_ml",
    "shbg_spatial_nmol_l",
    "dheas_spatial_ug_dl",
    "testosterone_spatial_ng_dl"
  ) %>% mutate(avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) /
                 2) %>% filter(!is.na(eTIV)) %>% mutate(
                   avg_t2_total_hipp = t2hipp_vol_avg_ca1 + t2hipp_vol_avg_ca23 + t2hipp_vol_avg_dg + t2hipp_vol_avg_sub,
                   left_t2_total_hipp = t2hipp_vol_left_ca1 + t2hipp_vol_left_ca23 + t2hipp_vol_left_dg + t2hipp_vol_left_sub,
                   right_t2_total_hipp = t2hipp_vol_right_ca1 + t2hipp_vol_right_ca23 + t2hipp_vol_right_dg + t2hipp_vol_right_sub
                 )  # N=43

midlife_HP_female_df <- midlife_HP_df %>% filter(sex=="Female")

midlife_HP_male_df <- midlife_HP_df %>%  filter(sex== "Male")
 
```

#### Checking normality

- Degrees traveled rad3 for all midlife is not normally distributed (p=0.04) and degrees traveled for men only ( p = 0.0001979)
- Position error was normally distributed for all groups 
- Angular error rad3 was normally distributed for alll groups
-  Angular error average for midlife was not normally distributed (p = 0.0007472) and it was not normally distributed for women only ( p-value = 0.004246)
```{r, echo=FALSE,message=FALSE}


#Creating an empty table to put everything in
normality_midlife_HP <- data.frame(matrix(ncol = 4, nrow = 0)) %>% `colnames<-`(c("statistic", "pvalue", "method", "variable"))

#LOOP: position error
normality_midlife_HP[1,] <- unlist(shapiro.test(midlife_HP_df$loop_pe_rad3_m)) #normal
normality_midlife_HP[2,] <- unlist(shapiro.test(midlife_HP_female_df$loop_pe_rad3_m)) #normal
normality_midlife_HP[3,] <- unlist(shapiro.test(midlife_HP_male_df$loop_pe_rad3_m)) #normal

#LOOP: position error average
normality_midlife_HP[4,] <-unlist(shapiro.test(midlife_HP_df$loop_pe_avg_m)) #normal
normality_midlife_HP[5,] <-unlist(shapiro.test(midlife_HP_female_df$loop_pe_avg_m)) #normal
normality_midlife_HP[6,] <-unlist(shapiro.test(midlife_HP_male_df$loop_pe_avg_m)) #normal

#LOOP: degrees traveled
normality_midlife_HP[7,] <-unlist(shapiro.test(midlife_HP_df$loop_de_rad3_degree))  #notnormal
normality_midlife_HP[8,] <-unlist(shapiro.test(midlife_HP_female_df$loop_de_rad3_degree))  #normal
normality_midlife_HP[9,] <-unlist(shapiro.test(midlife_HP_male_df$loop_de_rad3_degree) ) #notnormal

normality_midlife_HP[10,] <-unlist(shapiro.test(midlife_HP_df$loop_de_avg_degree))  #normal 
normality_midlife_HP[11,] <-unlist(shapiro.test(midlife_HP_female_df$loop_de_avg_degree))  #normal
normality_midlife_HP[12,] <-unlist(shapiro.test(midlife_HP_male_df$loop_de_avg_degree))  #normal


#LOOP: angular error
normality_midlife_HP[13,] <-unlist(shapiro.test(midlife_HP_df$loop_ae_rad3_degree))  #normal
normality_midlife_HP[14,] <-unlist(shapiro.test(midlife_HP_female_df$loop_ae_rad3_degree))  #normal
normality_midlife_HP[15,] <-unlist(shapiro.test(midlife_HP_male_df$loop_ae_rad3_degree))  #normal

normality_midlife_HP[16,] <-unlist(shapiro.test(midlife_HP_df$loop_ae_avg_degree))  # notnormal
normality_midlife_HP[17,] <-unlist(shapiro.test(midlife_HP_female_df$loop_ae_avg_degree))  #notnormal
normality_midlife_HP[18,] <-unlist(shapiro.test(midlife_HP_male_df$loop_ae_avg_degree))  #no


```

```{r}
knitr::kable(normality_midlife_HP) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "300px")
```


<br>
<br>

#### Behavior summarized


```{r}
loop_summarystats <- midlife_HP_df  %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years),
            AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
            AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
            PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
            PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
            DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
            DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame() 
```

```{r}
knitr::kable(loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")

```


#### T1 adjust correlations

Shuying originally did an adjustment using TIV from VBM.

I don't know if shuying and viasakh got the VBM for TIV the same. It looks like shuyings is multiplied by 1000x. 

Due to that, I am correcting using Freesurfer TIV



```{r, Correct for T1v}

#v contains adjusted hip
# 1 Create function for apply to variables
dividebyTIV <- function(x, na.rm = FALSE) (x/midlife_HP_df$eTIV)

# 2 Let's correct by mutating the columns using the TIV from freesurfer

midlife_HP_df_adj <- midlife_HP_df %>% mutate_at(vars(avg_t1_hipp, `Left-Hippocampus`, `Right-Hippocampus`),
            dividebyTIV) %>% 
  
  # multiplying to get proportions 
   mutate(avg_t1_hipp = avg_t1_hipp*1000,
         `Left-Hippocampus` = `Left-Hippocampus`*1000,
         `Right-Hippocampus` = `Right-Hippocampus`*1000)


midlife_HP_female_df_adj <- midlife_HP_df_adj %>% filter(sex=="Female")

midlife_HP_male_df_adj <- midlife_HP_df_adj %>%  filter(sex== "Male")

```

- I need to create a correlation matrix to house all of the results from the correlations so I can correct p values later

```{r, create empty data frame }
midlife_HP_correlations <- data.frame(matrix(ncol=9, nrow=0)) 
```

Now that things have been adjusted I need to do correlations


##### total T1 HP


**position Error**

- Position error avg is not significantly associated with t1 total hippocampus R=0.22, p=0.15

```{r, midlife total hippocampus aadjusted and position error average}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "Avg_PE_T1total")

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```


```{r, plot midlife total hippocampus adjusted and position error average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_avg_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```
<br>
<hr>

- Position error rad3 is not significantly associated with t1 total hippocampus R=0.11, p=0.52

```{r, midlife total hippocampus aadjusted and  position error rad3}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_rad3_m)) %>% mutate(analysis = "rad3_PE_T1total")

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```

```{r, plot midlife total hippocampus aadjusted and  position error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_rad3_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

**Angular Error**

- Angular error is not significantly associated with t1 total hippocampus R=0.066, p=0.67

```{r, midlife total hippocampus adjusted and angular error average}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_avg_degree, method = "spearman")) %>% mutate(analysis = "Avg_AE_T1total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```

```{r, plot midlife total hippocampus adjusted and angular error average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>
<hr>

- Angular error is not significantly associated with t1 total hippocampus R=0.1, p=0.54

```{r, midlife total hippocampus adjusted and angular error rad3}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_rad3_degree)) %>% mutate(analysis = "rad3_AE_T1total")

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```

```{r, plot midlife total hippocampus adjusted and angular error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```


**Degrees Traveled**

- Degrees Traveled  is not significantly associated with t1 total hippocampus R=-0.17, p=0.28
```{r, midlife total hippocampus adjusted and DT average}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T1total")

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```


```{r, plot midlife total hippocampus adjusted and DT average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```
<br>
<hr>

- degrees traveled is not significantly associated with t1 total hippocampus R=-0.079, p=0.63

```{r,midlife total hippocampus adjusted and degrees traveled error rad3}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T1total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```

```{r, plot midlife total hippocampus adjusted and degrees traveled error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled at 3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```



##### Left HP

** position Error **

- Position error avg is not significantly associated with t1 left hippocampus R=0.22, p=0.16
```{r, midlife left hippocampus adjusted and position error average}
# # Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = `Left-Hippocampus`, y = "loop_pe_avg_m",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

- Position error rad3 is not significantly associated with t1 left hippocampus R=0.012, p=0.48

```{r, midlife left hippocampus adjusted and position error rad3}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Left-Hippocampus", y = "loop_pe_rad3_m",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```


<br>

** Angular Error**

- Angular error is not significantly associated with t1 left hippocampus R=0.029, p=0.057

```{r, midlife left hippocampus adjusted and angular error average}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Left-Hippocampus", y = "loop_ae_avg_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

- Angular error is not significantly associated with t1 total hippocampus R=0.11, p=0.52

```{r, midlife left hippocampus adjusted and angular error rad3}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Left-Hippocampus", y = "loop_ae_rad3_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

** Degrees Traveled **

- Degrees Traveled  is not significantly associated with t1 Left-Hippocampus R=-0.015, p=0.32

```{r, midlife left hippocampus adjusted and DT average}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Left-Hippocampus", y = "loop_de_avg_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

- degrees traveled is not significantly associated with t1 Left-Hippocampus R=-0.051, p=0.76

```{r, midlife left hippocampus adjusted and degrees traveled rad3}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Left-Hippocampus", y = "loop_de_rad3_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "spearman",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "degrees traveled at 3.0  (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```



##### Right HP


** position Error **

- Position error avg is not significantly associated with t1 Right hippocampus R=0.22, p=0.15
```{r, midlife right hippocampus adjusted and position error average}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_avg_m",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

- Position error rad3 is not significantly associated with t1 right hippocampus R=0.0941, p=0.57

```{r, midlife right hippocampus adjusted and position error rad3}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_rad3_m",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```


<br>

** Angular Error**

- Angular error is not significantly associated with t1 right hippocampus R=0.029, p=0.062

```{r, midlife right hippocampus adjusted and angular error average}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_ae_avg_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

- Angular error is not significantly associated with t1 right hippocampus R=-0.093, p=0.58

```{r, midlife right hippocampus adjusted and angular error rad3}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_ae_rad3_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

** Degrees Traveled **

- Degrees Traveled  is not significantly associated with t1 Right-Hippocampus R=-0.0182, p=0.26

```{r, midlife right hippocampus adjustedand DT average}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_avg_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "pearson",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```

- degrees traveled is not significantly associated with t1 Right-Hippocampus R=-0.09, p=0.58

```{r, midlife right hippocampus adjusted and degrees traveled error rad3}
# Use hp data frame adjusted 
# ggscatter(midlife_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_rad3_degree",
#           add = "reg.line",
#           add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
#           cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
#           conf.int = TRUE, 
#           cor.method = "spearman",
#           cor.coeff.args = list(label.sep = "\n"),
#           xlab = "Averaged GMV Volume", ylab = "degrees traveled at 3.0  (m)", ) +
#     theme(legend.position = "top", legend.title=element_blank()) 

```


##### total T2 HP

**position Error**

- Position error avg is not significantly associated with t2 total hippocampus R=0.048, p=0.82

```{r,midlife total t2 hippocampus adjusted and position error average}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "avg_PE_T2total")

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```


```{r, Plot midlife total t2 hippocampus adjusted and position error average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_pe_avg_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

- Position error rad3 is not significantly associated with t2 total hippocampus R=-0.11, p=0.61


```{r, midlife total t2 hippocampus adjusted and position error rad3}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_rad3_m)) %>% mutate(analysis = "rad3_PE_T2total")

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```


```{r, plot midlife total t2 hippocampus adjusted and  position error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_pe_rad3_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>
<hr>

**Angular Error**

- Angular error is not significantly associated with t2 total hippocampus R=0.14, p=0.49


```{r, midlife t2 total hippocampus adjusted and angular error average}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_ae_avg_degree, method = "spearman")) %>% mutate(analysis = "Avg_AE_T2total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```

```{r, plot midlife t2 total hippocampus adjusted and angular error average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_ae_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```
<br>

- Angular error is not significantly associated with t2 total hippocampus R=-0.11, p=0.62

```{r, midlife t2 total hippocampus adjusted and angular error rad3}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_ae_rad3_degree)) %>% mutate(analysis = "rad3_AE_T2total" )

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```

```{r, plot midlife t2 total hippocampus adjusted and angular error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_ae_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>
<hr>

**Degrees Traveled**


- Degrees Traveled  is significantly associated with t2 total hippocampus R=-0.053, p=0.0049

```{r,  midlife t2 total hippocampus adjusted and DT average}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2total" )

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```


```{r,plot midlife t2 total hippocampus adjusted and DT average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_de_avg_degree",  size=4,
          add = "reg.line", color = "#7d4c5a",
          add.params = list(color = "#7d4c5a", fill = "#806d71"), # Customize reg. line
          #cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          #cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
     geom_hline(yintercept=360, linetype="dashed", color = "#414143", size=1) +
    theme(legend.position = "top", legend.title=element_blank()) 

```
<br>

- degrees traveled is not significantly associated with t2 total hippocampus R=-0.67, p=0.00061

```{r, midlife t2 total hippocampus adjusted and degrees traveled error rad3}
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2total" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

x <- x[,c(1,2,3,7,8,9,4,5,6)]

midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```


```{r, plot midlife t2 total hippocampus adjusted and degrees traveled error rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled at 3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

##### CA1

**Degrees Traveled**

- Degrees Traveled  is significantly associated with ca1 R=-0.53, p=0.0058

```{r, midlife CA1 and DT average}
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca1,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2CA1" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```


```{r, plot midlife CA1 and DT average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca1", y = "loop_de_avg_degree", size=4,
          add = "reg.line", color = "#7d4c5a",
          add.params = list(color = "#7d4c5a", fill = "#806d71"), # Customize reg. line
          #cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          #cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
   geom_hline(yintercept=360, linetype="dashed", color = "#414143", size=1) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Degrees Traveled rad3 is significantly associated with ca1 R=-0.7, p=0.00032


```{r,  midlife CA1 and DT rad3}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca1,midlife_HP_df_adj$loop_de_rad3_degree)) %>% mutate(analysis = "rad3_DT_T2CA1" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```


```{r, plot midlife CA1 and DT rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca1", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

##### CA23

- Degrees Traveled  is significantly associated with ca23 R=-0.54, p=0.0047

```{r,  midlife CA23 and DT avg}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca23,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2CA23" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```

```{r, midlife CA23 and DT average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca23", y = "loop_de_avg_degree",size=4,
          add = "reg.line", color = "#7d4c5a",
          add.params = list(color = "#7d4c5a", fill = "#806d71"), # Customize reg. line
          #cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          #cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
  geom_hline(yintercept=360, linetype="dashed", color = "#414143", size=1)+
    theme(legend.position = "top", legend.title=element_blank()) 

```


```{r,  midlife CA23 and DT rad3}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca23,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2CA23" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

x <- x[,c(1,2,3,7,8,9,4,5,6)]


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```

- Degrees Traveled rad3 is significantly associated with ca23 hippocampus R=-0.64, p=0.0014
```{r, plot midlife CA23 and DT rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca23", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```


##### DG

 Degrees Traveled  is significantly associated with DG R=-0.46, p=0.017

```{r,  midlife DG and DT avg}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_dg,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2DG" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```

```{r, plot midlife dg and DT average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_dg", y = "loop_de_avg_degree", size=4,
       add = "reg.line", color = "#7d4c5a",
          add.params = list(color = "#7d4c5a", fill = "#806d71"), # Customize reg. line
          #cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          #cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
  geom_hline(yintercept=360, linetype="dashed", color = "#414143", size=1) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

- Degrees Traveled rad3 is significantly associated with t2 total hippocampus R=-0.64, p=0.0014

```{r,  midlife dg and DT rad3}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_dg,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2DG" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

x <- x[,c(1,2,3,7,8,9,4,5,6)]


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```



```{r, plot midlife dg and DT rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_dg", y = "loop_de_rad3_degree",size=4,
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
  ca23_DEavg +
    theme(legend.position = "top", legend.title=element_blank()) 

```

##### sub

```{r,  midlife sub and DT avg}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_sub,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2sub" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```

Degrees Traveled  is significantly associated with sub R=-0.41, p=0.038
```{r, plot midlife sub and DT average}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_sub", y = "loop_de_avg_degree",size = 4,
         add = "reg.line", color = "#7d4c5a",
          add.params = list(color = "#7d4c5a", fill = "#806d71"), # Customize reg. line
          #cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          #cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
  geom_hline(yintercept=360, linetype="dashed", color = "#414143", size=1) +
    theme(legend.position = "top", legend.title=element_blank()) 


```


- Degrees Traveled rad3 is significantly associated with sub R=-0.69, p=0.00043

```{r,  midlife sub and DT rad3}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_sub,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2SUB" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

x <- x[,c(1,2,3,7,8,9,4,5,6)]


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```


```{r, plot midlife sub and DT rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_sub", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

##### EC

```{r,  midlife ERC and DT avg}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_erc,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2ERC" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```

Degrees Traveled  is significantly associated with DG R=-0.051, p=0.08
```{r, plot midlife ERC and DT avg}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_erc", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

```{r,  midlife ERC and DT rad3}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_erc,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2ERC" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

x <- x[,c(1,2,3,7,8,9,4,5,6)]


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```


- Degrees Traveled rad3 is significantly associated with t2 total hippocampus R=0.092, p=0.68
```{r, plot midlife ERC and DT rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_erc", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```



##### PHC 

```{r,  midlife PHC and DT avg}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_phc,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2PHC" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x

```

Degrees Traveled  is significantly associated with DG R=0.064, p=0.75
```{r, plot midlife PHC and DT avg}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_phc", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

```{r,  midlife PHC and DT rad3}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_phc,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2PHC" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

x <- x[,c(1,2,3,7,8,9,4,5,6)]


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x
```


- Degrees Traveled rad3 is significantly associated with t2 total hippocampus R=-0.11, p=0.61
```{r, plot midlife PHC and DT rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_phc", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```





##### PRC 

```{r,  midlife PRC and DT avg}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_prc,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T2PRC" )  


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x

```

Degrees Traveled  is significantly associated with DG R=0.064, p=0.75
```{r, plot midlife PRC and DT avg}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_prc", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Degrees Traveled rad3 is significantly associated with t2 total hippocampus R=0.1, p=0.64

```{r,  midlife PRC and DT rad3}

x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_prc,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2PRC" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

x <- x[,c(1,2,3,7,8,9,4,5,6)]


midlife_HP_correlations <- rbind(midlife_HP_correlations,x)

x
```


```{r, plot midlife PRC and DT rad3}
# Use hp data frame adjusted 
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_prc", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```


#### Summary

```{r, full corrleation results for all variables}

knitr::kable(midlife_HP_correlations) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "300px")

```


```{r, degrees traveled correlations for total average X subs}

Avg_DT_correlations <- midlife_HP_correlations %>% filter(grepl("DT",analysis)) %>% filter(grepl("Avg",analysis)) %>% filter(!grepl("total",analysis)) %>% mutate(correctedPvalue = p.adjust(p.value, method = "BH", n = 7))


rad3_DT_correlations <- midlife_HP_correlations %>% filter(grepl("DT",analysis)) %>% filter(grepl("rad3",analysis)) %>% filter(!grepl("total",analysis)) %>% mutate(correctedPvalue = p.adjust(p.value, method = "BH", n = 7))

```


```{r}
knitr::kable(Avg_DT_correlations) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "300px")
```

```{r}
knitr::kable(rad3_DT_correlations) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "300px")
```

<br>



#### Hormone Correlations
##### Estradiol

Here I am looking at hormones but only for the LOOP group and not all women with a T1 Scan. SO instead of n =74 like shuying, its n = 26


**T1 total hippocampus**

Estradiol was not significantly associated with total T1 hippocampal volume ( rs(24) = 0.065, p = 0.75)

```{r,  estradiol}

broom::tidy(cor.test(midlife_HP_female_df_adj$avg_t1_hipp,midlife_HP_female_df_adj$estradiol_spatial_pg_ml, method = "spearman")) 


```


```{r, estradiol and T1 adjusted}
ggscatter(midlife_HP_female_df_adj, x = "avg_t1_hipp", y = "estradiol_spatial_pg_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Estradiol", ) +
    theme(legend.position = "top", legend.title=element_blank()) 
```
<br>

**T2 total hippocampus**

estradiol was not significantly associated with T2 total hippocampal volume r  = -0.29, p=0.29
```{r, estradiol and T2 adjusted}
ggscatter(midlife_HP_female_df_adj, x = "avg_t2_total_hipp", y = "estradiol_spatial_pg_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Estradiol", ) +
    theme(legend.position = "top", legend.title=element_blank()) 
```


<br>

##### FSH

FSH was not significantly associated with total T1 hippocampal volume ( rs(24) = -0.16, p = 0.44)
```{r, FSH }
ggscatter(midlife_HP_female_df_adj, x = "avg_t1_hipp", y = "fsh_spatial_miu_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "FSH", ) +
    theme(legend.position = "top", legend.title=element_blank()) 
```
**T2 total hippocampus**

FSH was not significantly associated with T2 total hippocampal volume 
```{r, FSH and T2 adjusted}
ggscatter(midlife_HP_female_df_adj, x = "avg_t2_total_hipp", y = "fsh_spatial_miu_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "FSH", ) +
    theme(legend.position = "top", legend.title=element_blank()) 
```

##### Progesterone

**T1 total hippocampus**
Progesterone was not significantly associated with total T1 hippocampal volume ( rs(24) = 0.2, p = 0.32)

```{r, progesterone }
ggscatter(midlife_HP_female_df_adj, x = "avg_t1_hipp", y = "progesterone_spatial_ng_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "progesterone" ) +
    theme(legend.position = "top", legend.title=element_blank()) 
```
<br>

**T2 total hippocampus**

progesterone was not significantly associated with T2 total hippocampal volume r = -0.21 p=045
```{r, progesterone and T2 adjusted}
ggscatter(midlife_HP_female_df_adj, x = "avg_t2_total_hipp", y = "progesterone_spatial_ng_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "prog") +
    theme(legend.position = "top", legend.title=element_blank()) 
```

<br>

**avg ca1**

progesterone was not significantly associated with T2 total hippocampal volume r = -0.21 p=045
```{r, progesterone and T2 ca1 adjusted}
ggscatter(midlife_HP_female_df_adj, x = "t2hipp_vol_avg_ca1", y = "progesterone_spatial_ng_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "prog") +
    theme(legend.position = "top", legend.title=element_blank()) 
```

**avg ca23**

**avg DG**
```{r, progesterone and T2 DG adjusted}

ggscatter(midlife_HP_female_df_adj, x = "t2hipp_vol_avg_dg", y = "progesterone_spatial_ng_ml",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "prog") +
    theme(legend.position = "top", legend.title=element_blank()) 
```





### Young

For young adults hippocampal., we will use freesurfer and VBM. We need to put things into scale with the midlife 
- I need to create a correlation matrix to house all of the results from the correlations so I can correct p values later

```{r, create empty data frame }
young_HP_correlations <- data.frame(matrix(ncol=9, nrow=0)) 
```

#### Creating HP specific Dataframe : young

Total N - 31
    
    
```{r,collapse = TRUE}
# Let's create a clean df to work with here and include only the columns we want 

young_HP_df <-
 young_raw_df %>%  dplyr::select(
    "subject_id",
    "sex",
    "age_spatial_years",
    "loop_pe_rad3_m",
    "loop_pe_avg_m",
    "loop_de_rad3_degree",
    "loop_de_avg_degree",
    "loop_ae_rad3_degree",
    "loop_ae_avg_degree",
    "Left-Hippocampus",
    "Right-Hippocampus",
    "eTIV",
    "VaisTIV_VBM"
  ) %>% mutate(avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) /
                 2) %>% filter(!is.na(eTIV)) # Need to make sure we remove subj without scan # N=43
  
young_HP_female_df <- young_HP_df %>% filter(sex=="Female")

young_HP_male_df <- young_HP_df %>%  filter(sex== "Male")
 
```

#### Checking normality


```{r, echo=FALSE,message=FALSE}

#Creating an empty table to put everything in
normality_young_HP <- data.frame(matrix(ncol = 4, nrow = 0)) %>% `colnames<-`(c("statistic", "pvalue", "method", "variable"))

#LOOP: position error
normality_young_HP[1,] <- unlist(shapiro.test(young_HP_df$loop_pe_rad3_m)) #normal
normality_young_HP[2,] <- unlist(shapiro.test(young_HP_female_df$loop_pe_rad3_m)) #normal
normality_young_HP[3,] <- unlist(shapiro.test(young_HP_male_df$loop_pe_rad3_m)) #normal

#LOOP: position error average
normality_young_HP[4,] <-unlist(shapiro.test(young_HP_df$loop_pe_avg_m)) #normal
normality_young_HP[5,] <-unlist(shapiro.test(young_HP_female_df$loop_pe_avg_m)) #normal
normality_young_HP[6,] <-unlist(shapiro.test(young_HP_male_df$loop_pe_avg_m)) #normal

#LOOP: degrees traveled
normality_young_HP[7,] <-unlist(shapiro.test(young_HP_df$loop_de_rad3_degree))  #notnormal
normality_young_HP[8,] <-unlist(shapiro.test(young_HP_female_df$loop_de_rad3_degree))  #normal
normality_young_HP[9,] <-unlist(shapiro.test(young_HP_male_df$loop_de_rad3_degree) ) #notnormal

normality_young_HP[10,] <-unlist(shapiro.test(young_HP_df$loop_de_avg_degree))  #normal 
normality_young_HP[11,] <-unlist(shapiro.test(young_HP_female_df$loop_de_avg_degree))  #normal
normality_young_HP[12,] <-unlist(shapiro.test(young_HP_male_df$loop_de_avg_degree))  #normal


#LOOP: angular error
normality_young_HP[13,] <-unlist(shapiro.test(young_HP_df$loop_ae_rad3_degree))  #normal
normality_young_HP[14,] <-unlist(shapiro.test(young_HP_female_df$loop_ae_rad3_degree))  #normal
normality_young_HP[15,] <-unlist(shapiro.test(young_HP_male_df$loop_ae_rad3_degree))  #normal

normality_young_HP[16,] <-unlist(shapiro.test(young_HP_df$loop_ae_avg_degree))  # notnormal
normality_young_HP[17,] <-unlist(shapiro.test(young_HP_female_df$loop_ae_avg_degree))  #notnormal
normality_young_HP[18,] <-unlist(shapiro.test(young_HP_male_df$loop_ae_avg_degree))  #no


```

```{r}
knitr::kable(normality_young_HP) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "300px")
```


<br>
<br>

```{r}
young_loop_summarystats <- young_HP_df  %>% 
  group_by(sex) %>% 
  summarize(n_subject = n(),
            age_mean = mean(age_spatial_years),
            age_Sd = sd(age_spatial_years),
            AE_rad3 = mean(loop_ae_rad3_degree,na.rm=TRUE),
            AE_avg = mean(loop_ae_avg_degree ,na.rm=TRUE),
            PE_rad3 = mean(loop_pe_rad3_m,na.rm=TRUE),
            PE_avg = mean(loop_pe_avg_m,na.rm=TRUE),
            DT_rad3 = mean(loop_de_rad3_degree,na.rm=TRUE),
            DT_avg = mean(loop_de_avg_degree,na.rm=TRUE)) %>% as.data.frame() 
```

```{r}
knitr::kable(young_loop_summarystats) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "800px", height = "200")

```

#### Adjust TIV correlations

Shuying originally did an adjustment. so that's waht we're doing below. First we need to correct the T1 hippocampal volumes for TIV. T1 volumes and TIV are coming from freesurfers recon all. 
```{r, young Correct for T1v}


#v contains adjusted hip
# now we create the function for adjusting by TIV
# 1 Create function for apply to variables
Young_dividebyTIV <- function(x, na.rm = FALSE) (x/young_HP_df$eTIV)

# 2 Let's correct by mutating the columns using the TIV from freesurfer

young_HP_df_adj <- young_HP_df %>% mutate_at(vars(avg_t1_hipp, `Left-Hippocampus`, `Right-Hippocampus`),
            Young_dividebyTIV) %>% 
  
  # multiplying to get proportions 
   mutate(avg_t1_hipp = avg_t1_hipp*1000,
         `Left-Hippocampus` = `Left-Hippocampus`*1000,
         `Right-Hippocampus` = `Right-Hippocampus`*1000)

```


##### Total HP

**position Error**

- position error is not associated with T1 hippocampal volume in young adults R=-0.07, p=0.6916
-not normal using spearman 


```{r, young T1 total HP and PE avg}

temp_yng_cor <- broom::tidy(cor.test(young_HP_df_adj$avg_t1_hipp,young_HP_df_adj$loop_pe_avg_m, method = "spearman")) %>% mutate(analysis = "Avg_PE_T1total" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

temp_yng_cor <- temp_yng_cor[,c(1,2,3,7,8,9,4,5,6)]


young_HP_correlations <- rbind(young_HP_correlations,temp_yng_cor)

temp_yng_cor
```


```{r, plot young T1 total HP and PE avg}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_avg_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

- Position error rad3 is not associated with position error in young adults R=0.27, p=0.29
- not normal, using spearman

```{r, young T1 total HP and PE rad3}

temp_yng_cor <- broom::tidy(cor.test(young_HP_df_adj$avg_t1_hipp,young_HP_df_adj$loop_pe_rad3_m, method = "spearman")) %>% mutate(analysis = "rad3_PE_T1total" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

temp_yng_cor <- temp_yng_cor[,c(1,2,3,7,8,9,4,5,6)]


young_HP_correlations <- rbind(young_HP_correlations,temp_yng_cor)

temp_yng_cor
```


```{r, plot young T1 total HP and PE rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_pe_rad3_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

**Angular Error**

- Angular error is not associated with T1 hippocampal volume in young adults R=0.195, p=0.3
-not normal use spearman
```{r, young T1 total HP and AE avg}

temp_yng_cor <- broom::tidy(cor.test(young_HP_df_adj$avg_t1_hipp,young_HP_df_adj$loop_ae_avg_degree, method = "spearman")) %>% mutate(analysis = "Avg_AE_T1total" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

temp_yng_cor <- temp_yng_cor[,c(1,2,3,7,8,9,4,5,6)]


young_HP_correlations <- rbind(young_HP_correlations,temp_yng_cor)

temp_yng_cor
```

```{r, plot young T1 total HP and AE avg}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Angular error rad3 is not associated with position error in young adults. R=-0.271, p=0.293
- not normal using spearman
```{r, young T1 total HP and AE rad3}

temp_yng_cor <- broom::tidy(cor.test(young_HP_df_adj$avg_t1_hipp,young_HP_df_adj$loop_ae_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_AE_T1total" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")

temp_yng_cor <- temp_yng_cor[,c(1,2,3,7,8,9,4,5,6)]


young_HP_correlations <- rbind(young_HP_correlations,temp_yng_cor)

temp_yng_cor
```

```{r,young T1 total HP and AE rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_ae_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```


**Degrees Traveled**

- Degrees Traveled is not associated with T1 hippocampal volume in young adults R= - 0.067, p=0.73
```{r, young T1 total HP and DT Avg}

temp_yng_cor <- broom::tidy(cor.test(young_HP_df_adj$avg_t1_hipp,young_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T1total" ) 

young_HP_correlations <- rbind(young_HP_correlations,temp_yng_cor)

temp_yng_cor
```

```{r,plot young T1 total HP and DT Avg}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

-Degrees traveled rad3 is not associated with position error in young adults. R=-0.083, p=0.75
```{r, young T1 total HP and DT rad3}

temp_yng_cor <- broom::tidy(cor.test(young_HP_df_adj$avg_t1_hipp,young_HP_df_adj$loop_de_rad3_degree)) %>% mutate(analysis = "rad3_DT_T1total" ) 

young_HP_correlations <- rbind(young_HP_correlations,temp_yng_cor)

temp_yng_cor
```

```{r, plot young T1 total HP and DT rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "avg_t1_hipp", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

##### Right  

**position Error**

- position error is not associated with T1 right  hippocampal volume in young adults R=-0.019, p=0.92
- PE not normal use spearman
```{r, young right hippocampus adjusted and position error average}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_avg_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Position error rad3 is not associated with right hippocampal volume in young adults R=-0.067, p=0.8
- not normal use spearman
```{r, young right hippocampus adjusted  and position error rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_pe_rad3_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

** Angular Error **

- Angular error is not associated with T1 right hippocampal volume in young adults R=-0.00069, p=0.97
- notnormal use spearman
```{r, young right hippocampus adjusted  and angular error average}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_ae_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Angular error rad3 is not associated with position error in young adults. R=0.067, p=0.81

-not normal use spearman
```{r, young right hippocampus adjusted and angular error rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_ae_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```


** Degrees Traveled **

- Degrees Traveled is not associated with T1 hippocampal volume in young adults R= - 0.21, p=0.26
```{r, young right hippocampus adjusted and Degrees Traveled average}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- degrees  traveled rad3 is not associated with position error in young adults. R=-0.25, p=0.33

```{r, young right hippocampus adjusted  and degrees traveled rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Right-Hippocampus", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

##### Left

** position Error **

- position error is not associated with T1 left  hippocampal volume in young adults R=-0.072, p=0.71
- PE not normal use spearman
```{r, young left hippocampus adjusted  and position error average}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_pe_avg_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Position error rad3 is not associated with left hippocampal volume in young adults R=-0.012, p=0.65
- not normal use spearman
```{r, young left hippocampus adjusted and position error rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_pe_rad3_m",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Position Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>

** Angular Error **

- Angular error is not associated with T1 left hippocampal volume in young adults R=-0.099, p=0.6
- notnormal use spearman
```{r,young left hippocampus adjusted  and angular error average}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_ae_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Angular error rad3 is not associated with left hippocampal volume in young adults. R=0.012, p=0.65

-not normal use spearman
```{r, young left hippocampus adjusted and angular error rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_ae_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "spearman",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Angular Error at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```


** Degrees Traveled **

- Degrees Traveled is not associated with T1 left hippocampal volume in young adults R= -0.18, p=0.34
```{r, young left hippocampus adjusted  and Degrees Traveled average}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_de_avg_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at average (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

- Angular error rad3 is not associated with left hippocampal volume in young adults. R=-0.092, p=0.72

```{r, young left hippocampus adjusted  and degrees traveled rad3}
# Use hp data frame adjusted 
ggscatter(young_HP_df_adj, x = "Left-Hippocampus", y = "loop_de_rad3_degree",
          add = "reg.line",
          add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
          cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
          conf.int = TRUE, 
          cor.method = "pearson",
          cor.coeff.args = list(label.sep = "\n"),
          xlab = "Averaged GMV Volume", ylab = "Degrees Traveled at aver3.0  (m)", ) +
    theme(legend.position = "top", legend.title=element_blank()) 

```

<br>
## Cortical Thickness {.tabset .tabset-pills}

### DK atlas

```{r}

```


### Schaefar
- First i need to create a few cortical thickness data frames
```{r, creating cortical thickness data frames}

# first, let's create a dataframe with a fiew beh vars we'll need 

midlife_CT_df <- midlife_raw_df %>%  dplyr::select(
  "subject_id",
  "sex",
  "age_spatial_years",
  "repo_status",
  "loop_pe_rad3_m",
  "loop_pe_avg_m",
  "loop_de_rad3_degree",
  "loop_de_avg_degree",
  "loop_ae_rad3_degree",
  "loop_ae_avg_degree",
  "EstimatedTotalIntraCranialVol")




# now lets do some data wrangling to rename all of the schaefar columns by creating a variable with the master DF col names as rows, and then filtering by 17 networks. finally convert to a variable list of chars
schaefar_colnames <- as.data.frame(colnames(midlife_raw_df)) %>% `colnames<-`("schaefar_rois") %>% filter(grepl("17Networks", schaefar_rois))
schaefar_colnames <- as.character(schaefar_colnames[,1])

# now creating a temp df to select just the data for schaefar 
temp_ct_df <- midlife_raw_df %>%  dplyr::select(schaefar_colnames)



# creating a new var with updated names removing the 17 netowrks 
new_schaefar_colnames <- str_remove(schaefar_colnames,"17Networks_")


# replacing cols
temp_ct_df <- temp_ct_df %>% `colnames<-`(new_schaefar_colnames)

# adding to updated df 
midlife_CT_df <- cbind(midlife_CT_df,temp_ct_df)

# now let's work on the cortical thickness cleaning 

freesurfer_colnames <- as.data.frame(colnames(midlife_raw_df)) %>% `colnames<-`("freesurfer_rois") %>% filter(grepl("thickness", freesurfer_rois))
freesurfer_colnames <- as.character(freesurfer_colnames[,1])

# now creating a temp df to select just the data for schaefar 
temp_ct_df <- midlife_raw_df %>%  dplyr::select(freesurfer_colnames)

# creating a new var with updated names removing the 17 netowrks 
new_freesurfer_colnames <- str_remove(freesurfer_colnames,"_thickness")

# replacing cols
temp_ct_df <- temp_ct_df %>% `colnames<-`(new_freesurfer_colnames)

# adding to updated df 
midlife_CT_df <- cbind(midlife_CT_df,temp_ct_df)

temp_ct_df <- midlife_raw_df %>%  dplyr::select( "Left-Caudate","Right-Caudate","Left-Putamen","Right-Putamen","Left-Hippocampus","Right-Hippocampus")
#creating dataframe with all apriori regions
midlife_CT_df <- cbind(midlife_CT_df, temp_ct_df) %>% mutate(
  avg_t1_hipp = (.$`Left-Hippocampus` + .$`Right-Hippocampus`) / 2,
  avg_postcentral = lh_postcentral + rh_postcentral /
    2,
  avg_precentral = lh_precentral + rh_precentral / 2,
  avg_superior_parietal = lh_superiorparietal + rh_superiorparietal / 2,
  avg_superior_frontal = rh_superiorfrontal + lh_superiorfrontal / 2 , avg_caudate = `Left-Caudate` + `Right-Caudate` /2, avg_putamen = `Left-Putamen`,`Right-Putamen`
) %>% filter(EstimatedTotalIntraCranialVol != "NA") %>% filter(LH_ContA_Cingm_1 != "NA")

```

```{r, apriori lists}

#Scahefer Aprioris

schaefar_apriori_labelnames <-
  c(
    "LH_SomMotA",
    "LH_SomMotB_Cent",
    "LH_SomMotB_S2",
    "LH_SomMotB_Ins",
    "LH_SomMotB_Aud",
    "LH_DorsAttnA_TempOcc",
    "LH_DorsAttnA_ParOcc",
    "LH_DorsAttnA_SPL",
    "LH_DorsAttnB_PostC",
    "LH_DorsAttnB_FEF",
    "LH_DorsAttnB_PrCv",
    "LH_ContA_Temp",
    "LH_ContA_IPS",
    "LH_ContA_PFCd",
    "LH_ContA_PFCl",
    "LH_ContA_PFClv",
    "LH_ContA_Cingm",
    "LH_ContC_pCun",
    "LH_ContC_Cingp",
    "LH_DefaultA_IPL",
    "LH_DefaultA_PFCd",
    "LH_DefaultA_pCunPCC",
    "LH_DefaultA_PFCm",
    "LH_DefaultC_IPL",
    "LH_DefaultC_Rsp",
    "LH_DefaultC_PHC",
    "RH_SomMotA",
    "RH_SomMotB_Cent",
    "RH_SomMotB_S2",
    "RH_SomMotB_Ins",
    "RH_SomMotB_Aud",
    "RH_DorsAttnA_TempOcc",
    "RH_DorsAttnA_ParOcc",
    "RH_DorsAttnA_SPL",
    "RH_DorsAttnB_TempOcc",
    "RH_DorsAttnB_PostC",
    "RH_DorsAttnB_FEF",
    "RH_ContA_Temp" ,
    "RH_ContA_IPS",
    "RH_ContA_PFCd",
    "RH_ContA_PFCl",
    "RH_ContA_Cingm",
    "RH_ContC_pCun",
    "RH_ContC_Cingp",
    "RH_DefaultA_Temp",
    "RH_DefaultA_IPL",
    "RH_DefaultA_PFCd",
    "RH_DefaultA_pCunPCC",
    "RH_DefaultA_PFCm",
    "RH_DefaultC_Rsp",
    "RH_DefaultC_PHC"
  )

schaefar_apriori_networknames <-
  c(
    "LH_SomMotA",
    "LH_SomMotB",
    "LH_DorsAttnA",
    "LH_DorsAttnB",
    "LH_ContA",
    "LH_ContC",
    "LH_DefaultA",
    "LH_DefaultC",
    "RH_SomMotA",
    "RH_SomMotB",
    "RH_DorsAttnA",
    "RH_DorsAttnB",
    "RH_ContA",
    "RH_ContC",
    "RH_DefaultA",
    "RH_DefaultC"
  )


# now there's a lot of columns to select here so I'm going to try and make a few list of them so then we can grab by names 

# precentral, postcentral, superoir parietal, superior frontal, caudate and putamen 

FS_all_apriori <- c("lh_postcentral","lh_precentral","lh_superiorparietal","lh_superiorfrontal", "lh_cuneus","lh_medialorbitofrontal","lh_entorhinal","lh_parahippocampal","lh_precuneus","lh_lateraloccipital","lh_posteriorcingulate", "rh_postcentral","rh_precentral","rh_superiorparietal","rh_superiorfrontal","rh_cuneus","rh_medialorbitofrontal","rh_entorhinal","rh_parahippocampal","rh_precuneus","rh_lateraloccipital","rh_posteriorcingulate","Left-Caudate","Right-Caudate","Left-Putamen","Right-Putamen","Left-Hippocampus","Right-Hippocampus")

FS_avg_apriori <- c("avg_t1_hipp","avg_postcentral", "avg_precentral",
  "avg_superior_parietal", "avg_superior_frontal", "avg_caudate", "avg_putamen")
  

```

```{r}
#creating a schaefar df specifically 

midlife_schaefar_df <- midlife_CT_df  %>%  dplyr::select(
  "subject_id",
  "sex",
  "age_spatial_years",
  "repo_status",
  "loop_pe_rad3_m",
  "loop_pe_avg_m",
  "loop_de_rad3_degree",
  "loop_de_avg_degree",
  "loop_ae_rad3_degree",
  "loop_ae_avg_degree",
  "EstimatedTotalIntraCranialVol")
for (label in schaefar_apriori_labelnames) {
        temp <-
          midlife_CT_df %>% dplyr::select(matches(label)) %>% rowMeans() %>% as.data.frame() %>% `colnames<-`(label)
        
        midlife_schaefar_df <- cbind(midlife_schaefar_df, temp)
      }
```

### Degrees traveled

```{r, set up DT dataframes}

# Average
midlife_CT_df_Avg <- midlife_CT_df %>% filter(loop_de_avg_degree != "NA")
midlife_CT_df_Avg$sex[midlife_CT_df_Avg$sex=="Male"] <- 1 
midlife_CT_df_Avg$sex[midlife_CT_df_Avg$sex=="Female"] <- 0
midlife_CT_df_Avg$sex <- as.numeric(midlife_CT_df_Avg$sex)

midlife_CT_df_male_Avg <- midlife_CT_df_Avg %>% filter(sex==1)
midlife_CT_df_female_Avg <-midlife_CT_df_Avg %>% filter(sex==0)

#Rad3
  
midlife_CT_df_rad3 <- midlife_CT_df %>% filter(loop_de_rad3_degree != "NA")
midlife_CT_df_rad3$sex[midlife_CT_df_rad3$sex=="Male"] <- 1 
midlife_CT_df_rad3$sex[midlife_CT_df_rad3$sex=="Female"] <- 0
midlife_CT_df_rad3$sex <- as.numeric(midlife_CT_df_rad3$sex)

midlife_CT_df_male_rad3 <- midlife_CT_df_rad3 %>% filter(sex==1)
midlife_CT_df_female_rad3 <-midlife_CT_df_rad3 %>% filter(sex==0)


```

#### Freesurfer
##### all

**Average**
```{r, All DE Apriori Average,echo=FALSE, results='hide',message=FALSE, warning=FALSE}


cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_Avg[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_Avg[["loop_de_avg_degree"]], y = midlife_CT_df_Avg[[ROI]], z = midlife_CT_df_Avg[, c("age_spatial_years","sex","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```

<br> 

**Rad3**

```{r, All DE Apriori rad3,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_rad3[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_rad3[["loop_de_rad3_degree"]], y = midlife_CT_df_rad3[[ROI]], z = midlife_CT_df_rad3[, c("age_spatial_years","sex","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```
<br> 

##### Male

```{r, male DE Apriori Average,echo=FALSE, results='hide',message=FALSE, warning=FALSE}


cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_male_Avg[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_male_Avg[["loop_de_avg_degree"]], y = midlife_CT_df_male_Avg[[ROI]], z = midlife_CT_df_male_Avg[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```


```{r, All DE Apriori rad3,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_male_rad3[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_male_rad3[["loop_de_rad3_degree"]], y = midlife_CT_df_male_rad3[[ROI]], z = midlife_CT_df_male_rad3[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```

##### female
```{r, male DE Apriori Average,echo=FALSE, results='hide',message=FALSE, warning=FALSE}


cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_female_Avg[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_female_Avg[["loop_de_avg_degree"]], y = midlife_CT_df_female_Avg[[ROI]], z = midlife_CT_df_female_Avg[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```


```{r, All DE Apriori rad3,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_female_rad3[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_female_rad3[["loop_de_rad3_degree"]], y = midlife_CT_df_female_rad3[[ROI]], z = midlife_CT_df_female_rad3[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```

#### Schaefar
```{r, set up scahefer dataframes}

# Average
midlife_CT_df_Avg <- midlife_schaefar_df %>% filter(loop_de_avg_degree != "NA")
midlife_CT_df_Avg$sex[midlife_CT_df_Avg$sex=="Male"] <- 1 
midlife_CT_df_Avg$sex[midlife_CT_df_Avg$sex=="Female"] <- 0
midlife_CT_df_Avg$sex <- as.numeric(midlife_CT_df_Avg$sex)

midlife_CT_df_male_Avg <- midlife_CT_df_Avg %>% filter(sex==1)
midlife_CT_df_female_Avg <-midlife_CT_df_Avg %>% filter(sex==0)

#Rad3
  
midlife_CT_df_rad3 <- midlife_schaefar_df %>% filter(loop_de_rad3_degree != "NA")
midlife_CT_df_rad3$sex[midlife_CT_df_rad3$sex=="Male"] <- 1 
midlife_CT_df_rad3$sex[midlife_CT_df_rad3$sex=="Female"] <- 0
midlife_CT_df_rad3$sex <- as.numeric(midlife_CT_df_rad3$sex)

midlife_CT_df_male_rad3 <- midlife_CT_df_rad3 %>% filter(sex==1)
midlife_CT_df_female_rad3 <-midlife_CT_df_rad3 %>% filter(sex==0)


```

##### All 
**Average**
```{r, All DT schaefar network Apriori Average,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

 
for (ROI in schaefar_apriori_labelnames) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_Avg[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_Avg[["loop_de_avg_degree"]], y = midlife_CT_df_Avg[[ROI]], z = midlife_CT_df_Avg[, c("age_spatial_years","sex","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```

<br> 

**Rad3**

```{r, All DE Apriori rad3,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_rad3[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_rad3[["loop_de_rad3_degree"]], y = midlife_CT_df_rad3[[ROI]], z = midlife_CT_df_rad3[, c("age_spatial_years","sex","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```


### Angular error 

```{r, set up AE dataframes}

# Average
midlife_CT_df_Avg <- midlife_CT_df %>% filter(loop_ae_avg_degree != "NA")
midlife_CT_df_Avg$sex[midlife_CT_df_Avg$sex=="Male"] <- 1 
midlife_CT_df_Avg$sex[midlife_CT_df_Avg$sex=="Female"] <- 0
midlife_CT_df_Avg$sex <- as.numeric(midlife_CT_df_Avg$sex)

midlife_CT_df_male_Avg <- midlife_CT_df_Avg %>% filter(sex==1)
midlife_CT_df_female_Avg <-midlife_CT_df_Avg %>% filter(sex==0)

#Rad3
  
midlife_CT_df_rad3 <- midlife_CT_df %>% filter(loop_ae_rad3_degree != "NA")
midlife_CT_df_rad3$sex[midlife_CT_df_rad3$sex=="Male"] <- 1 
midlife_CT_df_rad3$sex[midlife_CT_df_rad3$sex=="Female"] <- 0
midlife_CT_df_rad3$sex <- as.numeric(midlife_CT_df_rad3$sex)

midlife_CT_df_male_rad3 <- midlife_CT_df_rad3 %>% filter(sex==1)
midlife_CT_df_female_rad3 <-midlife_CT_df_rad3 %>% filter(sex==0)


```

#### Freesurfer
##### all
```{r, All AE Apriori Average,echo=FALSE, results='hide',message=FALSE, warning=FALSE}


cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_Avg[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_Avg[["loop_ae_avg_degree"]], y = midlife_CT_df_Avg[[ROI]], z = midlife_CT_df_Avg[, c("age_spatial_years","sex","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```


 rad3 
```{r, All AE Apriori rad3,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_rad3[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_rad3[["loop_ae_rad3_degree"]], y = midlife_CT_df_rad3[[ROI]], z = midlife_CT_df_rad3[, c("age_spatial_years","sex","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "BY", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value, pi0=1)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```

#### Male

```{r, male AE Apriori Average,echo=FALSE, results='hide',message=FALSE, warning=FALSE}


cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_male_Avg[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_male_Avg[["loop_ae_avg_degree"]], y = midlife_CT_df_male_Avg[[ROI]], z = midlife_CT_df_male_Avg[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```


```{r, All AE Apriori rad3,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_male_rad3[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_male_rad3[["loop_ae_rad3_degree"]], y = midlife_CT_df_male_rad3[[ROI]], z = midlife_CT_df_male_rad3[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```

#### female
```{r, male DE Apriori Average,echo=FALSE, results='hide',message=FALSE, warning=FALSE}


cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_female_Avg[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_female_Avg[["loop_ae_avg_degree"]], y = midlife_CT_df_female_Avg[[ROI]], z = midlife_CT_df_female_Avg[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```


```{r, All DE Apriori rad3,echo=FALSE, results='hide',message=FALSE, warning=FALSE}

cor_results <-
  data.frame(matrix(nrow = 0, ncol = 7)) %>%   `colnames<-`(c("roi", "estimate", "p.value", "statistic", "n", "gp", "Method"))

pcorlist <- list()

for (ROI in FS_all_apriori) {
  
  print(ROI)
  if(!is.na(sum(midlife_CT_df_female_rad3[[ROI]])) == FALSE){

    pcorlist[[ROI]] <- NA

  }else{
  pcorlist[[ROI]] <-
    pcor.test(x = midlife_CT_df_female_rad3[["loop_ae_rad3_degree"]], y = midlife_CT_df_female_rad3[[ROI]], z = midlife_CT_df_female_rad3[, c("age_spatial_years","EstimatedTotalIntraCranialVol")], method = "spearman")
  temp <- cbind(ROI, pcorlist[[ROI]])
  cor_results <- rbind(cor_results, temp)
  }
}

# cor_results$adj.pval <- p.adjust(cor_results$p.value, method = "fdr", n = length(cor_results$p.value))
# cor_results <- arrange(cor_results,p.value)


```

```{r,echo=FALSE,message=FALSE}

qvals <- qvalue::qvalue(cor_results$p.value)
cor_results$adj.pval <- qvals[["qvalues"]]
cor_results <- arrange(cor_results,p.value)
cor_results
```

