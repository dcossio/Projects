conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca1", y = "loop_de_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca23", y = "loop_de_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_ca23", y = "loop_de_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "t2hipp_vol_avg_dg", y = "loop_de_avg_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled  at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
cor.test(midlife_HP_df_adj$loop_de_avg_degree,midlife_HP_df_adj$avg_t2_total_hipp)
cor.test(midlife_HP_df_adj$loop_de_avg_degree,midlife_HP_df_adj$avg_t2_total_hipp, adjust="BY")
p.adjust(x,method = "BY", n =5 )
x <- cor.test(midlife_HP_df_adj$loop_de_avg_degree,midlife_HP_df_adj$avg_t2_total_hipp)
p.adjust(x,method = "BY", n =5 )
cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_de_avg_degree)
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_pe_avg_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
View(midlife_HP_df_adj)
cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)
x <- cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)
View(x)
unlist(x)
x <- unlist(x)
midlife_HP_correlations <- as.data.frame()
midlife_HP_correlations <- data.frame(matric(ncol=6, nrow=0))
midlife_HP_correlations <- data.frame(matrix(ncol=6, nrow=0))
View(midlife_HP_correlations)
x
cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)
x <- cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)
View(x)
cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)
midlife_HP_correlations <- data.frame(matrix(ncol=5, nrow=0)) %>% `colnames<-`(c("Analysis", "t","df","p-value", "r estimate"))
x <- tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m))
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m))
View(x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate( analysis = "Avg_PE_T2total" )
View(x)
midlife_HP_correlations <- data.frame(matrix(ncol=9, nrow=0))
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_rad3_m)) %>% mutate(analysis = "Rad3_PE_T2total" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
View(midlife_HP_correlations)
midlife_HP_correlations <- data.frame(matrix(ncol=9, nrow=0))
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "Avg_PE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_rad3_m)) %>% mutate(analysis = "rad3_PE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_avg_degree)) %>% mutate(analysis = "avg_AE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_rad3_degree)) %>% mutate(analysis = "rad3_AE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = spearman)) %>% mutate(analysis = "rad3_DT_T1total")
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T1total")
View(x)
View(x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T1total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
View(x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T1total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
View(x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T1total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "avg_t1_hipp", y = "loop_de_rad3_degree",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "spearman",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "degrees traveled at 3.0  (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "avg_PE_T2total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
# Use hp data frame adjusted
ggscatter(midlife_HP_df_adj, x = "avg_t2_total_hipp", y = "loop_pe_avg_m",
add = "reg.line",
add.params = list(color = "black", fill = "lightgray"), # Customize reg. line
cor.coef = TRUE, # Add correlation coefficient. see ?stat_cor
conf.int = TRUE,
cor.method = "pearson",
cor.coeff.args = list(label.sep = "\n"),
xlab = "Averaged GMV Volume", ylab = "Position Error at average (m)", ) +
theme(legend.position = "top", legend.title=element_blank())
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "avg_PE_T2total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
midlife_HP_correlations <- data.frame(matrix(ncol=9, nrow=0))
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "Avg_PE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_pe_rad3_m)) %>% mutate(analysis = "rad3_PE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_avg_degree)) %>% mutate(analysis = "avg_AE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_ae_rad3_degree)) %>% mutate(analysis = "rad3_AE_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "Avg_DT_T1total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t1_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T1total") %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_avg_m)) %>% mutate(analysis = "avg_PE_T2total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_pe_rad3_m)) %>% mutate(analysis = "rad3_PE_T2total")
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_ae_avg_degree)) %>% mutate(analysis = "avg_AE_T2total" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_ae_rad3_degree)) %>% mutate(analysis = "rad3_AE_T2total" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "avg_DT_T2total" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$avg_t2_total_hipp,midlife_HP_df_adj$loop_de_rad3_degree, method = "spearman")) %>% mutate(analysis = "rad3_DT_T2total" )  %>% mutate(parameter = "NA", conf.low= "NA", conf.high= "NA")
x <- x[,c(1,2,3,7,8,9,4,5,6)]
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca1,midlife_HP_df_adj$loop_de_avg_degree)) %>% mutate(analysis = "avg_DT_T2CA1" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
x <- broom::tidy(cor.test(midlife_HP_df_adj$t2hipp_vol_avg_ca1,midlife_HP_df_adj$loop_de_rad3_degree)) %>% mutate(analysis = "rad3_DT_T2CA1" )
midlife_HP_correlations <- rbind(midlife_HP_correlations,x)
install.packages("outliers")
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
library(psych)
library(Rmisc)
library(ppcor)
library(outliers)
working_dir <-"/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/DSI/Maze/"
#working_dir <- "/Users/danielacossio/Desktop/MAZE/" #laptop
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)", "total volume(mm^3)")
sub_info <- read.csv(paste0(working_dir,"MazeDSI.csv")) # this is a csv that contains all of the important subject information.
sub_info$SEX[sub_info$SEX==1]<-c("Male")
sub_info$SEX[sub_info$SEX==0]<-c("Female")
sub_info$SEX <- as.factor(sub_info$SEX)
sub_info$REPO[sub_info$REPO==0]<-c("Male")
sub_info$REPO[sub_info$REPO==1]<-c("Pre")
sub_info$REPO[sub_info$REPO==2]<-c("Peri")
sub_info$REPO[sub_info$REPO==3]<-c("Post")
#Creating group DF
df_maze_fem <- sub_info %>% filter(SEX == "Female")
df_maze_male <- sub_info %>% filter(SEX == "Male")
df_maze_pre <- sub_info %>% filter(REPO == "Pre")
df_maze_peri <- sub_info %>% filter(REPO == "Peri")
df_maze_post <- sub_info %>% filter(REPO == "Post")
test <- grubbs.test(df_maze_fem$estradiol_spatial_pg_ml)
test <- grubbs.test(df_maze_fem$estradiol_spatial_pg_ml)
test
View(test)
test <- grubbs.test(df_maze_fem$fsh_spatial_miu_ml)
test
View(test)
View(df_maze_fem)
View(df_maze_fem)
test <- grubbs.test(sub_info$maze_accuracy_pct)
test
View(sub_info)
test <- grubbs.test(df_maze_fem$maze_accuracy_pct)
test
View(test)
test[["p.value"]]
test[["alternative"]]
test[["statistic"]]
test <- grubbs.test(df_maze_male$maze_accuracy_pct)
test
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
library(psych)
library(Rmisc)
library(ppcor)
library(outliers)
working_dir <-"/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/DSI/Maze/"
#working_dir <- "/Users/danielacossio/Desktop/MAZE/" #laptop
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)", "total volume(mm^3)")
sub_info <- read.csv(paste0(working_dir,"MazeDSI.csv")) # this is a csv that contains all of the important subject information.
ReadingCSVFunc <- function(pathname){
#README
#Purpose of this code is to read in the CSVs that I extract from the correlational tractography from DSI studio. You simply need to include the path to the CSV from the working directory. We set our working dir above so you just need the rest of the path.
read.delim(paste0(working_dir, pathname), header=FALSE,sep = "\t")
}
CleanInput <- function(DF){
#README
# The purpose of this function is to take the CSV that I extract from the correlational tractography and that has already been read into the script and made into a dataframe. It is then cleaned to create a clean output that grabs the following rows: "Tract Name", "number of tracts","mean length(mm)", "total volume(mm^3)"), and then re organizes the information for each subject into one dataframe. There's an if statement because some CSVs only have one significant tract and it needs a slightly different code to reorganize that.
DF <- DF %>% remove_empty("cols")
if(length(DF) < 3){
DF <- DF %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
as.data.frame() %>%
`[`(-c(1),)
} else{
DF <- DF %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
`[`(-c(1),) %>%
as.data.frame()
}
return(DF)
}
TableOutput <- function(df){
#Purpose of this is to create a clean table that can be shown on the html. Most of this is aesthetics but it's a lot so i created a function to reduce the clutter later.
# The DF that is input is a clean data frame of the correlational tractography. At this point it has gone through the ReadingCSVFunc, and CleanInput
knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = "600px", height = "300px")
}
# Extract_raw_values <- function(DF,Metric) {
#   # Purpose of this function is to clean the data without me having to copy and paste everything later. As well as extract
#
#   # Data = raw unclean dataframe we want to clean up
#   # Metric will be either MD or QA
#   # sex is either male or female
#
#
#   # Let's read in our data frame
#
#      colNames <- DF  %>% remove_empty("cols") %>%
#   filter(V1 == "Tract Name") %>% t() %>% `[`(-1)
#
#
#   # grab  ROIcolumn names
#
#
#   subinfo <- sub_info  %>% select(c("subject_id", "sex", "age_scan_years", "loop_pe_rad3_m", "loop_de_rad3_degree","REPO"))
#
#   # Let's grab our values
#   if (Metric == "MD"){
#     Values <- DF %>% remove_empty("cols") %>%
#      filter(str_detect(V1, c("mean_md"))) %>%
#    `colnames<-`(c("Subjects",colNames)) %>% filter(!str_detect(Subjects, c("sub-369")))
#   }
#   else{
#     Values <- DF %>%
#      remove_empty("cols") %>%
#       filter(str_detect(V1, c("mean_qa"))) %>%
#   `colnames<-`(c("Subjects",colNames)) %>% filter(!str_detect(Subjects, c("sub-369")))
#
#   }
#
#   # now let's put this together
#   if (length(Values) < 3) {
#     Values[,2] <- as.numeric(Values[,2])
#   }else{
#   ConvToNum <-  apply(Values[,2:length(Values)],2, as.numeric)
#   Values[,2:length(Values)] <- ConvToNum
#   }
#
#   cleanedDF <- cbind(subinfo,Values) %>% na.omit() %>% select(-c("Subjects"))
#
#   return (cleanedDF)
# }
# TableOutput <- function(df, style, width, height, caption){
#
#   if (style == "classic"){
#       knitr::kable(df, row.names=F) %>% kable_classic(full_width = F, html_font = "Cambria")
#   } else {
#       knitr::kable(df, row.names=F) %>% kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>% scroll_box(width = paste0(width,"px"), height = paste0(height,"px"))
#
#   }
#
# }
sub_info$SEX[sub_info$SEX==1]<-c("Male")
sub_info$SEX[sub_info$SEX==0]<-c("Female")
sub_info$SEX <- as.factor(sub_info$SEX)
sub_info$REPO[sub_info$REPO==0]<-c("Male")
sub_info$REPO[sub_info$REPO==1]<-c("Pre")
sub_info$REPO[sub_info$REPO==2]<-c("Peri")
sub_info$REPO[sub_info$REPO==3]<-c("Post")
#Creating group DF
df_maze_fem <- sub_info %>% filter(SEX == "Female")
df_maze_male <- sub_info %>% filter(SEX == "Male")
df_maze_pre <- sub_info %>% filter(REPO == "Pre")
df_maze_peri <- sub_info %>% filter(REPO == "Peri")
df_maze_post <- sub_info %>% filter(REPO == "Post")
df_maze_peri_post <- sub_info %>% filter(REPO != "Pre" )
View(df_maze_peri_post)
df_maze_peri_post <- sub_info %>% filter(REPO != "Pre" | REPO != "Male")
View(df_maze_peri_post)
df_maze_peri_post <- sub_info %>% filter(REPO != "Pre") %>% filter(REPO != "Male")
View(df_maze_peri_post)
test1 <- kruskal.test(maze_accuracy_pct~REPO,sub_info)
test1
sub_info$REPO[sub_info$REPO==2]<-c("Peri_Post")
sub_info$REPO[sub_info$REPO==3]<-c("Peri_Post")
View(sub_info)
working_dir <-"/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/DSI/Maze/"
#working_dir <- "/Users/danielacossio/Desktop/MAZE/" #laptop
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)", "total volume(mm^3)")
sub_info <- read.csv(paste0(working_dir,"MazeDSI.csv")) # this is a csv that contains all of the important subject information.
sub_info$SEX[sub_info$SEX==1]<-c("Male")
sub_info$SEX[sub_info$SEX==0]<-c("Female")
sub_info$SEX <- as.factor(sub_info$SEX)
sub_info$REPO[sub_info$REPO==0]<-c("Male")
sub_info$REPO[sub_info$REPO==1]<-c("Pre")
# sub_info$REPO[sub_info$REPO==2]<-c("Peri") # commenting these out bc i want to make a new combined label
# sub_info$REPO[sub_info$REPO==3]<-c("Post")
sub_info$REPO[sub_info$REPO==2]<-c("Peri_Post")
sub_info$REPO[sub_info$REPO==3]<-c("Peri_Post")
#Creating group DF
df_maze_fem <- sub_info %>% filter(SEX == "Female")
df_maze_male <- sub_info %>% filter(SEX == "Male")
df_maze_pre <- sub_info %>% filter(REPO == "Pre")
df_maze_peri <- sub_info %>% filter(REPO == "Peri")
df_maze_post <- sub_info %>% filter(REPO == "Post")
df_maze_peri_post <- sub_info %>% filter(REPO != "Pre") %>% filter(REPO != "Male")
sub_info %>% ggplot(aes(x = factor(REPO, levels=c("Male", "Pre", "Peri_Post")), y = maze_accuracy_pct, fill= REPO)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16, position=position_jitter(0.1)) +
scale_fill_manual(values=c("#6c6c6e","#7d4c5a", "#CD8A9B"))+
scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Wayfinding Success") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
#"#806d71"
# ggboxplot(sub_info, x = "REPO", y = "maze_accuracy_pct",
#           color = "REPO",
#           order = c("Male", "Pre", "Peri", "Post"),
#           ylab = "Wayfinding Success", xlab = "Group")
sub_info %>% ggplot(aes(x = factor(REPO, levels=c("Male", "Pre", "Peri_Post")), y = maze_accuracy_pct, fill= REPO)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16, position=position_jitter(0.1)) +
scale_fill_manual(values=c("#6c6c6e","#7d4c5a", "#CD8A9B"))+
scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Wayfinding Success") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
ggplot(df_maze_fem, aes(x=estradiol_spatial_pg_ml)) +
geom_bar(width = 10)
shapiro.test(df_maze_fem$estradiol_spatial_pg_ml)
pcor.test(df_maze_fem$estradiol_spatial_pg_ml,
df_maze_fem$maze_accuracy_pct,
df_maze_fem$age_spatial_years,
method = "spearman")
pcor.test(df_maze_fem$estradiol_spatial_pg_ml,
df_maze_fem$maze_accuracy_pct,
df_maze_fem$age_spatial_years,
method = "spearman")
View(df_maze_fem)
df_maze_fem %>% ggplot(aes(x = factor(REPO, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= REPO)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16, position=position_jitter(0.1)) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Wayfinding Success") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
#"#806d71"
# ggboxplot(sub_info, x = "REPO", y = "maze_accuracy_pct",
#           color = "REPO",
#           order = c("Male", "Pre", "Peri", "Post"),
#           ylab = "Wayfinding Success", xlab = "Group")
df_maze_fem %>% ggplot(aes(x = factor(REPO, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= REPO)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16, position=position_jitter(0.1)) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Wayfinding Success") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
#"#806d71"
# ggboxplot(sub_info, x = "REPO", y = "maze_accuracy_pct",
#           color = "REPO",
#           order = c("Male", "Pre", "Peri", "Post"),
#           ylab = "Wayfinding Success", xlab = "Group")
wilcox.test(df_maze_pre$estradiol_spatial_pg_ml, df_maze_peri_post$estradiol_spatial_pg_ml)
