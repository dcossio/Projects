wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
df_DSP_pre %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
df_DSP_peri_post %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
df_DSP_pre %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
df_DSP_peri_post %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
View(df_DSP_peri_post)
df_DSP_peri_post <- Behavioronly_data_dsp %>% filter(repo_status != "Pre") %>% filter(repo_status != "Men")
wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
df_DSP_pre %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
df_DSP_peri_post %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
ttest <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
ttest$p.value
p.adjust(ttest$p.value)
help("p.adjust")
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
est_wilx_test
df_DSP_pre %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
df_DSP_peri_post %>% dplyr::summarise(count = n(), mean = mean(estradiol_spatial_pg_ml, na.rm = TRUE), sd = sd(estradiol_spatial_pg_ml, na.rm = TRUE))
prog_wilx_test <- wilcox.test(df_DSP_pre$progesterone_spatial_ng_ml, df_DSP_peri_post$progesterone_spatial_ng_ml)
prog_wilx_test
df_DSP_pre %>% dplyr::summarise(count = n(), mean = mean(progesterone_spatial_ng_ml, na.rm = TRUE), sd = sd(progesterone_spatial_ng_ml, na.rm = TRUE))
df_DSP_peri_post %>% dplyr::summarise(count = n(), mean = mean(progesterone_spatial_ng_ml, na.rm = TRUE), sd = sd(progesterone_spatial_ng_ml, na.rm = TRUE))
prog_wilx_test <- wilcox.test(df_DSP_pre$progesterone_spatial_ng_ml, df_DSP_peri_post$progesterone_spatial_ng_ml)
prog_wilx_test
df_DSP_pre %>% dplyr::summarise(count = n(), mean = mean(progesterone_spatial_ng_ml, na.rm = TRUE), sd = sd(progesterone_spatial_ng_ml, na.rm = TRUE))
df_DSP_peri_post %>% dplyr::summarise(count = n(), mean = mean(progesterone_spatial_ng_ml, na.rm = TRUE), sd = sd(progesterone_spatial_ng_ml, na.rm = TRUE))
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= REPO)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = progesterone_spatial_ng_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = progesterone_spatial_ng_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = fsh_spatial_miu_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("FSH") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = fsh_spatial_miu_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("FSH") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
working_dir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/DSI/DSP"
behavior_sub_info <- read.csv("/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/sub_info_sheets/SNAG_Behavior.csv") # This is a sheet that has all of the subjects with at least one usable behavior task (Loop, maze, dsp). Filtering 352 here because i didn't manually exclude in this sheet
DSP_DSI_DF <- read.csv("/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/sub_info_sheets/DSPDSI.csv") %>% filter(!is.na(subject_id)) %>%  filter(subject_id != 352) # This is from the main subject sheet and includes all subjects that have a dsp score AND should have a scan with them
library(ggplot2)
#(plyr)
library(tidyverse)
# library(dplyr)
# library(tidyr)
library(stringr)
library(kableExtra)
# library(data.table)
# library(network)
# library(tidygraph)
# library(ggraph)
# library(igraph)
# library(networkD3)
# library(CINNA)
# library(umap)
# library(plotly)
#library(factoextra)
#library(lsr)
# library(car)
library(ggpubr)
#library(entropy)
#library(ds4psy)
# library(pROC)
#library(devtools)
#library(BRRR)
#library(stats)
#library(afex)
library(knitr)
library(janitor)
library(car)
library(ggiraph)
library(ggiraphExtra)
library(moonBook)
library(nationalparkcolors)
library(gridExtra)
library(markdown)
library(psych)
library(ppcor)
library(mediation)
##### Mac Desktop path
working_dir <- "/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/DSI/DSP"
behavior_sub_info <- read.csv("/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/sub_info_sheets/SNAG_Behavior.csv") # This is a sheet that has all of the subjects with at least one usable behavior task (Loop, maze, dsp). Filtering 352 here because i didn't manually exclude in this sheet
DSP_DSI_DF <- read.csv("/Users/danielacossio/Documents/Chrastil_Lab/Projects/SNAG/sub_info_sheets/DSPDSI.csv") %>% filter(!is.na(subject_id)) %>%  filter(subject_id != 352) # This is from the main subject sheet and includes all subjects that have a dsp score AND should have a scan with them
###### Laptop path
# working_dir <- "/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/DSI/DSP"
#
# behavior_sub_info <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/sub_info_sheets/SNAG_Behavior.csv")
#
#
# DSP_DSI_DF <- read.csv("/Users/danielacossio/Library/CloudStorage/GoogleDrive-dcossio1@uci.edu/Other computers/My iMac/Chrastil_Lab/Projects/SNAG/sub_info_sheets/DSPDSI.csv") %>%  filter(!is.na(subject_id)) %>%  filter(subject_id != 352)
# combining peri and post into one group
behavior_sub_info$repo_status[behavior_sub_info$repo_status =="Peri"]<-c("Peri_Post")
behavior_sub_info$repo_status[behavior_sub_info$repo_status =="Post"]<-c("Peri_Post")
DSP_DSI_DF$repo_status[DSP_DSI_DF$repo_status =="Peri"]<-c("Peri_Post")
DSP_DSI_DF$repo_status[DSP_DSI_DF$repo_status =="Post"]<-c("Peri_Post")
rows2grab <- c("Tract Name", "number of tracts","mean length(mm)","span(mm)", "total volume(mm^3)")
f_data_dsp <- DSP_DSI_DF %>% filter(sex == "Female")
m_data_dsp<- DSP_DSI_DF %>% filter(sex=="Male")
Behavioronly_data_dsp <- behavior_sub_info %>% filter(dsp_useable == "Yes") %>% filter(subject_id < 500) # dataframe with all subjects that have usable DSP
Behavioronly_Female_data_dsp <- behavior_sub_info %>% filter(dsp_useable == "Yes") %>% filter(subject_id < 500) %>%  filter(sex=="Female")
# Creating seperate databases for groups
#Creating group DF
df_DSP_fem <- Behavioronly_data_dsp %>% filter(sex == "Female")
df_DSP_male <- Behavioronly_data_dsp %>% filter(sex == "Male")
df_DSP_pre <- Behavioronly_data_dsp %>% filter(repo_status == "Pre")
df_DSP_peri_post <- Behavioronly_data_dsp %>% filter(repo_status != "Pre") %>% filter(repo_status != "Men")
ReadingCSVFunc <- function(pathname){
read.delim(paste0(working_dir, pathname), header=FALSE,sep = "\t")
#README
#Purpose: to read in the CSVs that I extract from the correlational tractography from DSI studio.
#Inputs: You simply need to include the path to the CSV from the working directory. We set our working dir above so you just need the rest of the path.
}
CleanInput <- function(DF){
#README
# The purpose of this function is to take the CSV that I extract from the correlational tractography and that has already been read into the script and made into a dataframe. It is then cleaned to create a clean output that grabs the following rows: "Tract Name", "number of tracts","mean length(mm)", "total volume(mm^3)"), and then re organizes the information for each subject into one dataframe. There's an if statement because some CSVs only have one significant tract and it needs a slightly different code to reorganize that.
#INPUT: Should take in a DF that was created when you read in the CSV from the correlational tract analysis. The output of the ReadingCSVFunc
DF <- DF %>% remove_empty("cols")
if(length(DF) < 3){
DF <- DF %>%
filter(V1 %in% rows2grab) %>%
t() %>%
`colnames<-`(rows2grab) %>%
as.data.frame() %>%
`[`(-c(1),)
} else{
DF <- DF %>%
filter(V1 %in% rows2grab) %>%
t() %>%  `colnames<-`(rows2grab) %>% as.data.frame(x = .) %>%
`[`(-c(1),)
}
return(DF)
}
Extract_raw_values <- function(DF,Metric) {
# Purpose of this function is to clean the data without me having to copy and paste everything later.
# Data = raw unclean dataframe we want to clean up
# Metric will be either MD or QA
# sex is either male or female
# Let's read in our data frame
# grab  ROIcolumn names
colNames <- DF  %>% remove_empty("cols") %>%
filter(V1 == "Tract Name") %>% t() %>% `[`(-1)
subinfo <- DSP_DSI_DF  %>% dplyr::select(c("subject_id", "sex", "age_scan_years", "dsp_si_true_pct", "estradiol_spatial_pg_ml","estradiol_scan_pg_ml","testosterone_spatial_ng_dl", "fsh_spatial_miu_ml","fsh_spatial_miu_ml","progesterone_scan_ng_ml","progesterone_spatial_ng_ml"))
# Let's grab our values
if (Metric == "MD"){
Values <- DF %>% remove_empty("cols") %>%
filter(str_detect(V1, c("mean_md"))) %>%
`colnames<-`(c("Subjects",colNames))
}
else{
Values <- DF %>%
remove_empty("cols") %>%
filter(str_detect(V1, c("mean_qa"))) %>%
`colnames<-`(c("Subjects",colNames)) %>% filter(!str_detect(Subjects, c("sub-369")))
}
# now let's put this together
ConvToNum <-  apply(Values[,2:length(Values)],2, as.numeric)
Values[,2:length(Values)] <- ConvToNum
cleanedDF <- cbind(subinfo,Values) %>% na.omit() %>% dplyr::select(-c("Subjects"))
return (cleanedDF)
}
TableOutput <- function(df){
knitr::kable(df, row.names=F) %>%
kable_styling(bootstrap_options =  c("striped", "hover", "condensed")) %>%
scroll_box(width = "800px", height = "300px")
}
Behavioronly_data_dsp %>% dplyr::summarise(count = n(), mean = mean(age_spatial_years, na.rm = TRUE), sd = sd(age_spatial_years, na.rm = TRUE), min(age_spatial_years, na.rm = TRUE), max(age_spatial_years, na.rm = TRUE))
group_by(Behavioronly_data_dsp, sex) %>% dplyr::summarise(count = n(), mean = mean(age_spatial_years, na.rm = TRUE), sd = sd(age_spatial_years, na.rm = TRUE), min(age_spatial_years, na.rm = TRUE), max(age_spatial_years, na.rm = TRUE))
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = estradiol_spatial_pg_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Estradiol") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = progesterone_spatial_ng_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("Progesterone") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = fsh_spatial_miu_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("FSH") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
= fsh_spatial_miu_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("FSH") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
df_DSP_fem %>% ggplot(aes(x = factor(repo_status, levels=c("Pre", "Peri_Post")), y = fsh_spatial_miu_ml, fill= repo_status)) +
geom_boxplot(width=0.5,fatten = 1, show.legend = FALSE) +
geom_point(shape=16) +
scale_fill_manual(values=c("#7d4c5a", "#CD8A9B"))+
#scale_y_continuous(breaks = seq(0, 1, by = 0.2)) +
xlab("Sex")+
ylab("FSH") +
theme(axis.title.x = element_text(vjust=- 4, size = 16),
axis.title.y = element_text(vjust=8, size = 16),
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold" )
)
est_wilx_test
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml)
est_wilx_test
est_wilx_test
summarise(est_wilx_test
)
as.data.frame(est_wilx_test)
broom::tidy(est_wilx_test)
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy()
View(est_wilx_test)
colnames(est_wilx_test)
hormone_comparision <-  data.frame(matrix(ncol = 5, nrow = 0)) %>% `colnames<-`(c("hormone","statistic","p.value","method","alternative"))
help("order")
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() mutate(hormone = "Estradiol")
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol")
View(est_wilx_test)
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% [,c("hormone","statistic","p.value","method","alternative")]
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% est_wilx_test[,c("hormone","statistic","p.value","method","alternative")]
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% c("hormone","statistic","p.value","method","alternative")
View(est_wilx_test)
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol")
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>%  [c("hormone","statistic","p.value","method","alternative")]
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% select("hormone",everything())
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol")
View(est_wilx_test)
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% select("hormone", "statistic","p.value","method","alternative")
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% dyplr::select("hormone",everything())
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% dplyr::select("hormone",everything())
View(est_wilx_test)
est_wilx_test <- wilcox.test(df_DSP_pre$estradiol_spatial_pg_ml, df_DSP_peri_post$estradiol_spatial_pg_ml) %>% broom::tidy() %>%  mutate(hormone = "Estradiol") %>% dplyr::select("hormone",everything())
hormone_comparision <- rbind(hormone_comparision, est_wilx_test)
View(hormone_comparision)
prog_wilx_test <- wilcox.test(df_DSP_pre$progesterone_spatial_ng_ml, df_DSP_peri_post$progesterone_spatial_ng_ml)  %>% broom::tidy() %>%  mutate(hormone = "Progesterone") %>% dplyr::select("hormone",everything())
hormone_comparision <- rbind(hormone_comparision, prog_wilx_test)
FSH_wilx_test <- wilcox.test(df_DSP_pre$fsh_spatial_miu_ml, df_DSP_peri_post$fsh_spatial_miu_ml)  %>% broom::tidy() %>%  mutate(hormone = "FSH") %>% dplyr::select("hormone",everything())
hormone_comparision <- rbind(hormone_comparision, FSH_wilx_test)
df_DSP_pre %>% dplyr::summarise(count = n(), mean = mean(fsh_spatial_miu_ml, na.rm = TRUE), sd = sd(fsh_spatial_miu_ml, na.rm = TRUE))
df_DSP_peri_post %>% dplyr::summarise(count = n(), mean = mean(fsh_spatial_miu_ml, na.rm = TRUE), sd = sd(fsh_spatial_miu_ml, na.rm = TRUE))
View(hormone_comparision)
p_corrected <- p.adjust(hormone_comparision$p.value, "BY")
View(prog_wilx_test)
p_corrected <- p.adjust(hormone_comparision$p.value, "BY")
hormone_comparision <- hormone_comparision %>% mutate(p.value.BYCorrected = p_corrected)
View(hormone_comparision)
p_corrected <- p.adjust(hormone_comparision$p.value, "BY")
hormone_comparision <- hormone_comparision %>% mutate(p.value.BYCorrected = p_corrected)
hormone_comparision
options(scipen=999)
p_corrected <- p.adjust(hormone_comparision$p.value, "BY")
hormone_comparision <- hormone_comparision %>% mutate(p.value.BYCorrected = p_corrected)
hormone_comparision
View(FSH_wilx_test)
View(df_DSP_fem)
View(behavior_sub_info)
View(hormone_comparision)
# Using
#PDF 9 X 6
ggplot(data = Behavioronly_Female_data_dsp, aes(x = estradiol_spatial_pg_ml,
y = dsp_si_true_pct, color=repo_status)) +
geom_point(aes(color = factor(repo_status)), size=2) +
scale_color_manual(values=c("#CD8A9B", "#7d4c5a","#414143")) +
stat_smooth(method = "lm",
formula = y ~ x,
geom = "smooth",
color="Black",
se=FALSE)+
theme(panel.background =element_blank(),
axis.line = element_line(colour = "black"),
axis.title.x=element_blank(),
axis.title.y=element_blank(),
legend.position="none",
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
ggplot(data = FSH__Female_data_dsp, aes(x = fsh_spatial_miu_ml,
y = dsp_si_true_pct)) +
geom_point(aes(color = factor(repo_status)), size=4) +
scale_color_manual(values=c("#2c5f5d", "#2f3c31","#1c1c1e")) +
stat_smooth(method = "lm",
formula = y ~ x,
geom = "smooth",
color="Black",
se=FALSE) +
theme(panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
# we need to make a new DF for FSH specifc people
FSH__Female_data_dsp <- Behavioronly_Female_data_dsp %>% filter(!is.na(fsh_spatial_miu_ml))
# this one uses spatial hormones
cor.test(FSH__Female_data_dsp$fsh_spatial_miu_ml,
FSH__Female_data_dsp$dsp_si_true_pct,
conf.level = 0.95,
alternative = "less",
method = "spearman")
# #This one uses scan hormones
# cor.test(Behavioronly_Female_data_dsp$fsh_spatial_miu_ml,
#          Behavioronly_Female_data_dsp$dsp_si_true_pct,
#          conf.level = 0.95,
#          alternative = "less",
#          method = "spearman")
ggplot(data = FSH__Female_data_dsp, aes(x = fsh_spatial_miu_ml,
y = dsp_si_true_pct)) +
geom_point(aes(color = factor(repo_status)), size=4) +
scale_color_manual(values=c("#2c5f5d", "#2f3c31","#1c1c1e")) +
stat_smooth(method = "lm",
formula = y ~ x,
geom = "smooth",
color="Black",
se=FALSE) +
theme(panel.background =element_blank(),
axis.line = element_line(colour = "black"),
plot.margin = margin(1, 2, 1, 1.5, "cm"),
plot.title = element_text(hjust = 0.5, vjust = 2, size = 16, face="bold"))
